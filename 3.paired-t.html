
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>The Paired t-test &#8212; Linear Models with Correlated Errors</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=a80109f0" />
    <link rel="stylesheet" type="text/css" href="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rgl.css?v=57907efa" />
    <link rel="stylesheet" type="text/css" href="_static/sphericity_3d_files/htmltools-fill-0.5.8.1/fill.css?v=971cc1da" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3.paired-t';</script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/textures.src.js?v=9482728f"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/shadersrc.src.js?v=6ce05c17"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/buffer.src.js?v=1efca185"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/mouse.src.js?v=96f0b970"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/projection.src.js?v=98871b91"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/axes.src.js?v=3250d244"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rglTimer.src.js?v=ac1c3151"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/pretty.src.js?v=4f2cffba"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/shaders.src.js?v=bbbdf37d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/animation.src.js?v=74f9b9e8"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/pieces.src.js?v=280fd571"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/selection.src.js?v=5b47ed7d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/init.src.js?v=f5bdcbbb"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/subscenes.src.js?v=42cb429d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/controls.src.js?v=4b3dbe6f"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/draw.src.js?v=49d9cbaa"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/utils.src.js?v=56efe719"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rglClass.src.js?v=9e593197"></script>
    <script src="_static/sphericity_3d_files/rglWebGL-binding-1.3.18/rglWebGL.js?v=8cd6f6d7"></script>
    <script src="_static/sphericity_3d_files/htmlwidgets-1.6.4/htmlwidgets.js?v=175713be"></script>
    <script src="_static/sphericity_3d_files/CanvasMatrix4-1.3.18/CanvasMatrix.src.js?v=5a2d04be"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="One-way Repeated Measures ANOVA" href="4.rm-anova.html" />
    <link rel="prev" title="Probability Models" href="2.probability.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Linear Models with Correlated Errors - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Linear Models with Correlated Errors - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.designs.html">Repeated Measurements</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.probability.html">Probability Models</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">The Paired <em>t</em>-test</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.rm-anova.html">One-way Repeated Measures ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors/issues/new?title=Issue%20on%20page%20%2F3.paired-t.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/3.paired-t.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Paired t-test</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-vs-paired-t-tests">Two-sample vs Paired <em>t</em>-tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model-of-paired-differences">The Model of <em>Paired Differences</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paired-differences-in-r">Paired Differences in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-the-effect-of-the-subjects">Removing the Effect of the Subjects</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inference-in-the-model-of-paired-differences">Inference in the Model of <em>Paired Differences</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-model-with-two-error-terms">A Model with <em>Two</em> Error Terms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-variance-in-the-model-of-paired-differences">Error Variance in the Model of <em>Paired Differences</em></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-paired-t-test">
<h1>The Paired <em>t</em>-test<a class="headerlink" href="#the-paired-t-test" title="Link to this heading">#</a></h1>
<p>At this point in the lesson, we have established what repeated measures designs are, why they cause problems and how we can use the multivariate normal distribution as a general probabilistic framework for accommodating correlation. We will now move on to discussing models that are suitable for repeated measurements. The most basic repeated measures scenario is when we have <em>two</em> measurements from each subject. In this situation, it is typical to use a <em>paired</em> <span class="math notranslate nohighlight">\(t\)</span>-test. Given what we have now established, our interest lies in <em>how</em> the paired <span class="math notranslate nohighlight">\(t\)</span>-test is able to accommodate correlation. As we will discuss below, rather than modelling the correlation directly, the paired <span class="math notranslate nohighlight">\(t\)</span>-test is structured such that the correlation is effectively <em>removed</em> from the data. Although this <em>side-steps</em> many of the issues around repeated measurements, understanding <em>why</em> this works is key for for developing more complex and general-purpose approaches.</p>
<section id="two-sample-vs-paired-t-tests">
<h2>Two-sample vs Paired <em>t</em>-tests<a class="headerlink" href="#two-sample-vs-paired-t-tests" title="Link to this heading">#</a></h2>
<p>To begin with, it is useful to examine <em>how</em> the results differ between a <em>two-sample</em> and <em>paired</em> <span class="math notranslate nohighlight">\(t\)</span>-test. We can don this in <code class="docutils literal notranslate"><span class="pre">R</span></code> by comparing the results of the <code class="docutils literal notranslate"><span class="pre">t.test()</span></code> function with <code class="docutils literal notranslate"><span class="pre">paired=FALSE</span></code> and <code class="docutils literal notranslate"><span class="pre">paired=TRUE</span></code>. To do this, we use the <code class="docutils literal notranslate"><span class="pre">mice2</span></code> data set from the <code class="docutils literal notranslate"><span class="pre">datarium</span></code> package. This contains the weight of a sample of 10 mice both <em>before</em> and <em>after</em> some treatment. The experimental question concerns whether the treatment affects the weight of the mice. The data is shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;datarium&#39;</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="s">&#39;mice2&#39;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">mice2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   id before after
1   1  187.2 429.5
2   2  194.2 404.4
3   3  231.7 405.6
4   4  200.5 397.2
5   5  201.7 377.9
6   6  235.0 445.8
7   7  208.7 408.4
8   8  172.4 337.0
9   9  184.6 414.3
10 10  189.6 380.3
</pre></div>
</div>
</div>
</div>
<p>We can compare the output from a <em>two-sample</em> <span class="math notranslate nohighlight">\(t\)</span>-test and a <em>paired</em> <span class="math notranslate nohighlight">\(t\)</span>-test by changing the <code class="docutils literal notranslate"><span class="pre">paired=</span></code> argument of <code class="docutils literal notranslate"><span class="pre">t.test()</span></code>, as shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">t.test</span><span class="p">(</span><span class="n">mice2</span><span class="o">$</span><span class="n">before</span><span class="p">,</span><span class="w"> </span><span class="n">mice2</span><span class="o">$</span><span class="n">after</span><span class="p">,</span><span class="w"> </span><span class="n">var.equal</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">paired</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span><span class="w">  </span><span class="c1"># paired t-test</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">t.test</span><span class="p">(</span><span class="n">mice2</span><span class="o">$</span><span class="n">before</span><span class="p">,</span><span class="w"> </span><span class="n">mice2</span><span class="o">$</span><span class="n">after</span><span class="p">,</span><span class="w"> </span><span class="n">var.equal</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">paired</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">))</span><span class="w"> </span><span class="c1"># two-sample t-test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Paired t-test

data:  mice2$before and mice2$after
t = -25.546, df = 9, p-value = 1.039e-09
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -217.1442 -181.8158
sample estimates:
mean difference 
        -199.48 


	Two Sample t-test

data:  mice2$before and mice2$after
t = -17.453, df = 18, p-value = 9.974e-13
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -223.4926 -175.4674
sample estimates:
mean of x mean of y 
   200.56    400.04 
</pre></div>
</div>
</div>
</div>
<p>The output is a bit different between the two methods, so let us spend a little time unpacking this. To begin with, the clearest differences concern the <span class="math notranslate nohighlight">\(t\)</span>-statistic itself, the degrees of freedom, the <span class="math notranslate nohighlight">\(p\)</span>-value and the confidence interval. These are summarised in the table below</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Test</p></th>
<th class="head"><p><em>t</em>-statistic</p></th>
<th class="head"><p>DoF</p></th>
<th class="head"><p><em>p</em>-value</p></th>
<th class="head"><p>95% CI</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Paired</p></td>
<td><p>-25.546</p></td>
<td><p>9</p></td>
<td><p>1.039e-09</p></td>
<td><p>[-217.14 -181.82]</p></td>
</tr>
<tr class="row-odd"><td><p>Two-sample</p></td>
<td><p>-17.453</p></td>
<td><p>18</p></td>
<td><p>9.974e-13</p></td>
<td><p>[-223.49 -175.47]</p></td>
</tr>
</tbody>
</table>
</div>
<p>Although it may seem like <em>everything</em> is different, there is actually one element that is <em>identical</em>, though it is somewhat hidden. To see it, consider that the structure of a <span class="math notranslate nohighlight">\(t\)</span>-test is</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\mu_{1} - \mu_{2}}{\text{SE}\{\mu_{1} - \mu_{2}\}},
\]</div>
<p>meaning that we think of the <span class="math notranslate nohighlight">\(t\)</span> as the ratio between the <em>mean difference</em> and the <em>standard error of the mean difference</em>. The <span class="math notranslate nohighlight">\(t\)</span>-statistic itself is different between the <em>two-sample</em> and the <em>paired</em> tests, but this does not necessarily mean that all elements of this ratio are also different. Indeed, if we look at the output above we can see that the <em>paired</em> test reports a mean difference of <code class="docutils literal notranslate"><span class="pre">-199.48</span></code> and the <em>two-sample</em> test reports the individual means as <code class="docutils literal notranslate"><span class="pre">200.56</span></code> and <code class="docutils literal notranslate"><span class="pre">400.04</span></code>. If we calculate the mean difference from the values reported by the <em>two-sample</em> test we get</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="m">200.56</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">400.04</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] -199.48
</pre></div>
</div>
</div>
</div>
<p>So, this is <em>identical</em> between the <em>paired</em> and <em>two-sample</em> tests. This should not be surprising, as we already established that repeated measurements do not affect the mean function. However, this does make it clear that it is not the <em>numerator</em> that differs between the paired and two-sample tests. As such, it must be the <em>denominator</em> of the <span class="math notranslate nohighlight">\(t\)</span>-statistic that leads to the differences above. In other words, <em>the standard error of the difference changes under repeated measurements</em>.</p>
<p>Given that we know the numerator for both tests, we can recover the denominators and see that this is true</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mean.diff</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-199.48</span>
<span class="n">paired.t</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-25.546</span>
<span class="n">twosamp.t</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-17.453</span>
<span class="n">paired.se</span><span class="w">  </span><span class="o">&lt;-</span><span class="w">  </span><span class="n">mean.diff</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">paired.t</span>
<span class="n">twosamp.se</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="n">mean.diff</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">twosamp.t</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">paired.se</span><span class="p">,</span><span class="w"> </span><span class="n">twosamp.se</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1]  7.808659 11.429554
</pre></div>
</div>
</div>
</div>
<p>The <em>standard error</em> of the difference is much <em>smaller</em> in the <em>paired</em> test (<code class="docutils literal notranslate"><span class="pre">7.81</span></code>), compared to the <em>two-sample</em> test (<code class="docutils literal notranslate"><span class="pre">11.43</span></code>). This should not be a surprise as we know that the variance of the difference between two random variables should get <em>smaller</em> when they are positively correlated. From this, we can conclude that the standard error in the two-sample test is <em>too large</em> for this particular dataset, which has led to a <span class="math notranslate nohighlight">\(t\)</span>-statistic that is <em>smaller</em> than it should be. Application of the wrong method here has led to a <em>loss</em> of statistical power.</p>
<p>This tracks with everything we have discussed so far. However, the key question remains <em>how</em> the paired <span class="math notranslate nohighlight">\(t\)</span>-test is able to do this? There are two equivalent ways of conceptualising this, but the simplest is to think of a paired <span class="math notranslate nohighlight">\(t\)</span>-test as a model of <em>differences</em> between the repeated measurements. This is the perspective we will discuss below. The alternative perspective will be presented when we start discussing the <em>repeated measures ANOVA</em> as a generalisation of the paired <span class="math notranslate nohighlight">\(t\)</span>-test.</p>
</section>
<section id="the-model-of-paired-differences">
<h2>The Model of <em>Paired Differences</em><a class="headerlink" href="#the-model-of-paired-differences" title="Link to this heading">#</a></h2>
<p>The key idea behind the <em>paired differences</em> approach is that a paired <span class="math notranslate nohighlight">\(t\)</span>-test is identical to a <em>one-sample</em> <span class="math notranslate nohighlight">\(t\)</span>-test on the <em>differences</em> between the pairs. This is a really key conceptual step because it introduces the idea that we can correctly model repeated measurements by <em>removing</em> something from the data. If we can make the paired test correct via subtraction it means that we are able to <em>remove</em> correlation and make the data <em>independent</em>. As we will see further below, formalising this idea allows us to conceptualise models of repeated measures in a more general fashion that will be useful going forward.</p>
<section id="paired-differences-in-r">
<h3>Paired Differences in <code class="docutils literal notranslate"><span class="pre">R</span></code><a class="headerlink" href="#paired-differences-in-r" title="Link to this heading">#</a></h3>
<p>As a first step, we can demonstrate that the idea of subtracting pairs <em>does</em> work. We can use the <code class="docutils literal notranslate"><span class="pre">mice2</span></code> data again and create a new variable that represents the <em>difference</em> between <code class="docutils literal notranslate"><span class="pre">before</span></code> and <code class="docutils literal notranslate"><span class="pre">after</span></code> the treatment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mice2</span><span class="o">$</span><span class="n">treat.diff</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mice2</span><span class="o">$</span><span class="n">before</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mice2</span><span class="o">$</span><span class="n">after</span>
<span class="nf">print</span><span class="p">(</span><span class="n">mice2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   id before after treat.diff
1   1  187.2 429.5     -242.3
2   2  194.2 404.4     -210.2
3   3  231.7 405.6     -173.9
4   4  200.5 397.2     -196.7
5   5  201.7 377.9     -176.2
6   6  235.0 445.8     -210.8
7   7  208.7 408.4     -199.7
8   8  172.4 337.0     -164.6
9   9  184.6 414.3     -229.7
10 10  189.6 380.3     -190.7
</pre></div>
</div>
</div>
</div>
<p>Now, we can simply perform a one-sample <span class="math notranslate nohighlight">\(t\)</span>-test on the difference. To do this, we could use the <code class="docutils literal notranslate"><span class="pre">t.test()</span></code> function, but given that our general focus is linear models, we will use <code class="docutils literal notranslate"><span class="pre">lm()</span></code> instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">onesamp.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">treat.diff</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mice2</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">onesamp.mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = treat.diff ~ 1, data = mice2)

Residuals:
   Min     1Q Median     3Q    Max 
-42.82 -11.17   1.28  19.66  34.88 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -199.480      7.809  -25.55 1.04e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 24.69 on 9 degrees of freedom
</pre></div>
</div>
</div>
</div>
<p>The test on the intercept parameter <span class="math notranslate nohighlight">\((\beta_{0})\)</span> is now <em>identical</em> to the paired <span class="math notranslate nohighlight">\(t\)</span>-test from earlier. Importantly, we have done <em>nothing</em> to explicitly model the covariance structure. Indeed, remember that <code class="docutils literal notranslate"><span class="pre">lm()</span></code> assumes that there is <em>no</em> correlation in the data. So, we have now managed to analyse repeated measurements using a model that assumes that there are no repeated measurements. In effect, we have <em>created</em> independent data via subtraction.</p>
</section>
<section id="removing-the-effect-of-the-subjects">
<h3>Removing the Effect of the Subjects<a class="headerlink" href="#removing-the-effect-of-the-subjects" title="Link to this heading">#</a></h3>
<p>Given the demonstration above, the key insight is that taking <span class="math notranslate nohighlight">\(d_{i} = y_{i1} - y_{i2}\)</span> allows us to treat the values of <span class="math notranslate nohighlight">\(d_{i}\)</span> as <em>independent</em>. This means that this subtraction <em>must</em> be removing the correlation from the data. This is fairly intuitive because we have reduced correlated pairs of data down to only a single value per-subject. Given that the subjects are <em>independent</em>, the values of <span class="math notranslate nohighlight">\(d_{i}\)</span> must also be independent. In effect, there are <em>no</em> repeated measurements anymore. However, expressing this formally is a useful stepping-stone to more general approaches.</p>
<p>To see what is happening, let us return to our basic <span class="math notranslate nohighlight">\(t\)</span>-test model from last semester, where we parameterised each group mean in terms of the grand mean plus a group-specific deflection. The model is given by</p>
<div class="math notranslate nohighlight">
\[
y_{ij} = \mu + \alpha_{j} + \epsilon_{ij},
\]</div>
<p>so the means of the two repeated measurements are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    E(y_{i1}) &amp;= \mu_{1} = \mu + \alpha_{1} \\
    E(y_{i2}) &amp;= \mu_{2} = \mu + \alpha_{2}.
\end{alignat*}
\end{split}\]</div>
<p>To capture the concept of <em>dependence</em> between these repeats, we will now <em>split</em> the error into <em>two</em> components. This may seem an odd step, but stick with it because this simple maneuver is key to understanding why the paired <span class="math notranslate nohighlight">\(t\)</span>-test works. So, we take our error term and define <span class="math notranslate nohighlight">\(\epsilon_{ij} = S_{i} + \eta_{ij}\)</span>. This now consists of a <em>shared component</em> for each subject, called <span class="math notranslate nohighlight">\(S_{i}\)</span>, as well as a <em>unique component</em> for each observation, called <span class="math notranslate nohighlight">\(\eta_{ij}\)</span>. For the two repeated measurements, the model is now</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    y_{i1} &amp;= \mu + \alpha_{1} + \overbrace{S_{i} + \eta_{i1}}^{\epsilon_{ij}} \\
    y_{i2} &amp;= \mu + \alpha_{2} + S_{i} + \eta_{i2} 
\end{alignat*}.
\end{split}\]</div>
<p>So, the reason why <span class="math notranslate nohighlight">\(y_{i1}\)</span> and <span class="math notranslate nohighlight">\(y_{i2}\)</span> are correlated is because they <em>share</em> the same component <span class="math notranslate nohighlight">\(S_{i}\)</span>. This captures the idea that these measurements come from the <em>same subject</em>. If we then <em>subtract</em> <span class="math notranslate nohighlight">\(y_{i1}\)</span> and <span class="math notranslate nohighlight">\(y_{i2}\)</span>, the term <span class="math notranslate nohighlight">\(S_{i}\)</span> will cancel-out</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    d_{i} = y_{i1} - y_{i2} &amp;= (\mu_{1} + S_{i} + \eta_{i1}) - (\mu_{2} + S_{i} + \eta_{i2}) \\
                            &amp;= (\mu_{1} + \eta_{i1}) - (\mu_{2} + \eta_{i2})
\end{alignat*}.
\end{split}\]</div>
<p>Because we end up with a single value of <span class="math notranslate nohighlight">\(d_{i}\)</span> per-subject, these values must be <em>independent</em> because the subjects are <em>independent</em>. So, because the subtraction removes <span class="math notranslate nohighlight">\(S_{i}\)</span>, this tells us that <span class="math notranslate nohighlight">\(S_{i}\)</span> <em>must</em> capture the <em>correlation</em>. As such, the simple act of splitting the error term into <em>two parts</em> directly explains exactly <em>how</em> and <em>why</em> the paired <span class="math notranslate nohighlight">\(t\)</span>-test works.</p>
<div class="tip admonition">
<p class="admonition-title">A Poetic Explanation</p>
<p>In their book “Analysis of Repeated Measures”, Crowder and Hand (1990) refer to the elements of the model</p>
<div class="math notranslate nohighlight">
\[
y_{ij} = \mu + \alpha_{j} + S_{i} + \eta_{ij}
\]</div>
<p>in a more poetic way that may help get a sense of what the model terms are capturing. They refer to <span class="math notranslate nohighlight">\(\mu_{j} = \mu + \alpha_{j}\)</span> as an “immutable constant of the universe”, <span class="math notranslate nohighlight">\(S_{i}\)</span> as a “lasting characteristic of the individual” and <span class="math notranslate nohighlight">\(\eta_{ij}\)</span> as a “fleeting aberration of the moment”. So, <span class="math notranslate nohighlight">\(\mu_{j} = \mu + \alpha_{j}\)</span> represents something fundamental and universal about the effect of the different treatments that is true across all measurements of those treatments. <span class="math notranslate nohighlight">\(S_{i}\)</span> captures something that is specific and unique to subject <span class="math notranslate nohighlight">\(i\)</span> that is true across all their repeated measurements, and <span class="math notranslate nohighlight">\(\eta_{ij}\)</span> represents random noise that occurred at the point of measurement that is unrelated to the experimental condition or the individual.</p>
</div>
</section>
</section>
<section id="inference-in-the-model-of-paired-differences">
<h2>Inference in the Model of <em>Paired Differences</em><a class="headerlink" href="#inference-in-the-model-of-paired-differences" title="Link to this heading">#</a></h2>
<p>Earlier, we indicated that a key difference between a <em>paired</em> <span class="math notranslate nohighlight">\(t\)</span>-test and a <em>two-sample</em> <span class="math notranslate nohighlight">\(t\)</span>-test was the standard error used for the test statistic. We will now see how this aligns with the model of <em>paired differences</em> and the idea of <em>splitting</em> the error term into <span class="math notranslate nohighlight">\(\epsilon_{ij} = S_{i} + \eta_{ij}\)</span> and then <em>removing</em> the <span class="math notranslate nohighlight">\(S_{i}\)</span> terms.</p>
<section id="a-model-with-two-error-terms">
<h3>A Model with <em>Two</em> Error Terms<a class="headerlink" href="#a-model-with-two-error-terms" title="Link to this heading">#</a></h3>
<p>To understand the consequences of splitting the error in two, recall that in the normal linear model the errors are a random variable of the form</p>
<div class="math notranslate nohighlight">
\[
\epsilon_{ij} \sim \mathcal{N}(0,\sigma^{2}).
\]</div>
<p>As such, when we split the errors, we get <em>two</em> random variables of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    S_{i}     &amp;\sim \mathcal{N}(0,\sigma^{2}_{1}) \\
    \eta_{ij} &amp;\sim \mathcal{N}(0,\sigma^{2}_{2}).
\end{alignat*}
\end{split}\]</div>
<p>We do not assume these have the same variance and thus we now have <em>two</em> variances as well. So, not only have we <em>partitioned</em> the errors, we have also <em>partitioned</em> the variance into two separate chunks</p>
<div class="math notranslate nohighlight">
\[
\text{Var}\left(y_{ij}\right) = \sigma^{2} = \sigma^{2}_{1} + \sigma^{2}_{2}.
\]</div>
<p>This says that the variation in our data is the sum of two separate chunks that come from two different sources. Within the context of a basic repeated measures model, these variance components are often called the <em>between-subjects</em> variance and the <em>within-subject</em> variance. So we can equivalently write the distribution of the errors as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    S_{i}     &amp;\sim \mathcal{N}(0,\sigma^{2}_{b}) \\
    \eta_{ij} &amp;\sim \mathcal{N}(0,\sigma^{2}_{w}).
\end{alignat*}
\end{split}\]</div>
<p>In this scheme, <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span> captures variation due to the fact that we have measured <em>different subjects</em>, and <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> captures variation of measurement <em>within each subject</em>. We therefore think of variation in these data as attributable to two different sources of error. One concerns the fact that we have different people in the data and the other concerns the fact that we have multiple measurements from each person in the data. We can therefore specify this model more generally as</p>
<div class="math notranslate nohighlight">
\[
y_{ij} \sim\mathcal{N}(\mu + \alpha_{j}, \sigma^{2}_{b} + \sigma^{2}_{w})
\]</div>
<p>We will discuss this model specification in more detail in the next part of this lesson, as it is a key result that leads us both to the repeated measures ANOVA and the mixed-effects models that are the focus of this section of the unit.</p>
</section>
<section id="error-variance-in-the-model-of-paired-differences">
<h3>Error Variance in the Model of <em>Paired Differences</em><a class="headerlink" href="#error-variance-in-the-model-of-paired-differences" title="Link to this heading">#</a></h3>
<p>Now, let us circle back to the paired <span class="math notranslate nohighlight">\(t\)</span>-test and the idea of subtracting the pairs to remove the correlation. So, sticking with the concept of a model with <em>two</em> error variances, what happens when we take the <em>difference</em> <span class="math notranslate nohighlight">\(d_{i} = y_{i1} - y_{i2}\)</span>? Remember from the beginning of this lesson that the variance of the difference between two random variables is given by</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(y_{1} - y_{2}) = \text{Var}(y_{1}) + \text{Var}(y_{2}) - 2\text{Cov}(y_{1},y_{2}).
\]</div>
<p>As such, the variance of <span class="math notranslate nohighlight">\(d_{i}\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{3}
    \text{Var}(d_{i}) &amp;= \text{Var}(y_{i1}) &amp;&amp;+ \text{Var}(y_{i2}) &amp;&amp;- 2\text{Cov}(y_{i1},y_{i2}) \\
                      &amp;= \left(\sigma^{2}_{b} + \sigma^{2}_{w}\right) &amp;&amp;+ \left(\sigma^{2}_{b} + \sigma^{2}_{w}\right) &amp;&amp;- 2\text{Cov}(y_{i1},y_{i2})
\end{alignat*}
\end{split}\]</div>
<p>For reasons we will give in the next part of the lesson, the covariance between the repeated measurements is</p>
<div class="math notranslate nohighlight">
\[
\text{Cov}(y_{i1},y_{i2}) = \sigma^{2}_{b}.
\]</div>
<p>Although this might seem an unintuitive result, stick with it for the moment. We will provide more intuition about this later in the unit. For now, let us see what happens when we put all this together</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    \text{Var}(d_{i}) &amp;= \left(\sigma^{2}_{b} + \sigma^{2}_{w}\right) + \left(\sigma^{2}_{b} + \sigma^{2}_{w}\right) - 2\sigma^{2}_{b} \\
                      &amp;= 2\sigma^{2}_{w} + 2\sigma^{2}_{b} - 2\sigma^{2}_{b}  \\
                      &amp;= 2\sigma^{2}_{w}
\end{alignat*}
\end{split}\]</div>
<p>So, when we subtract the repeated measurements, <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span> <em>disappears</em> and we are only left with <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. This is exactly the same idea as <span class="math notranslate nohighlight">\(S_{i}\)</span> disappearing in the subtraction, as well as the idea of the correlation disappearing in the subtraction. The only variance left in <span class="math notranslate nohighlight">\(d_{i}\)</span> is <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. This means that the standard errors can only be based on <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>, which is always going to be smaller than <span class="math notranslate nohighlight">\(\sigma^{2}_{w} + \sigma^{2}_{b}\)</span>, which is what the <em>two-sample</em> <span class="math notranslate nohighlight">\(t\)</span>-test is using.</p>
<p>Putting this all together, the paired <span class="math notranslate nohighlight">\(t\)</span>-test works because subtracting the repeated measurements cancels the term <span class="math notranslate nohighlight">\(S_{i}\)</span>. This both removes the correlation <em>and</em> removes a portion of the overall error variance. What is left represents only the <em>within-subject</em> variance. Because this is always <em>smaller</em> than the total variance, the standard error of the difference is <em>also</em> smaller. This makes the associated <span class="math notranslate nohighlight">\(t\)</span>-statistic <em>bigger</em> in the paired case, even though the mean difference never changes. In effect, this scheme allows correlation to be incorporated and the standard error adjusted in an entirely mechanistic way, simply by calculating the <em>difference</em> between the pairs.</p>
<aside class="topic">
<p class="topic-title">What do you now know?</p>
<p>In this section, we have explored the paired <span class="math notranslate nohighlight">\(t\)</span>-test as the most basic model of repeated measurements. After reading this section, you should have a good sense of :</p>
<ul class="simple">
<li><p>The core differences when we apply a paired <span class="math notranslate nohighlight">\(t\)</span>-test vs a two-sample <span class="math notranslate nohighlight">\(t\)</span>-test to the same data in terms of the test statistic, degrees of freedom and confidence interval.</p></li>
<li><p>The concept that the <em>numerator</em> of the <span class="math notranslate nohighlight">\(t\)</span>-statistic does not change under repeated measurements, but the <em>denominator</em> (the <em>standard error of the differences</em>) does.</p></li>
<li><p>The idea that a paired <span class="math notranslate nohighlight">\(t\)</span>-test can be conceptualised as a <em>one-sample</em> <span class="math notranslate nohighlight">\(t\)</span>-test on the <em>differences</em> between the pairs.</p></li>
<li><p>The idea that subtracting the pairs renders the data <em>independent</em> because this <em>removes the correlation</em>.</p></li>
<li><p>The idea that we can conceptualise <em>why</em> this happens by:</p>
<ul>
<li><p>Splitting the model error into two parts, one that captures a <em>shared component</em> for each subject and one that captures <em>independent error</em>.</p></li>
<li><p>Seeing how this <em>shared component</em> is the element that <em>cancels</em> under subtraction and thus <em>must</em> be the element that explains the correlation between the repeated measurements.</p></li>
<li><p>Seeing that the only remaining variance reflects <em>within-subject</em> deviations that are <em>smaller</em> than the total variance.</p></li>
<li><p>Seeing that this <em>within-subject</em> variance is the only element that can feeds into the standard errors and thus explaining why the standard errors are <em>smaller</em> for the paired test compared to the two-sample test.</p></li>
</ul>
</li>
</ul>
</aside>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="2.probability.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Probability Models</p>
      </div>
    </a>
    <a class="right-next"
       href="4.rm-anova.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">One-way Repeated Measures ANOVA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-vs-paired-t-tests">Two-sample vs Paired <em>t</em>-tests</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model-of-paired-differences">The Model of <em>Paired Differences</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#paired-differences-in-r">Paired Differences in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#removing-the-effect-of-the-subjects">Removing the Effect of the Subjects</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inference-in-the-model-of-paired-differences">Inference in the Model of <em>Paired Differences</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-model-with-two-error-terms">A Model with <em>Two</em> Error Terms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-variance-in-the-model-of-paired-differences">Error Variance in the Model of <em>Paired Differences</em></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>