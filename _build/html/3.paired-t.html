
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>The Paired \(t\)-test &#8212; Linear Models with Correlated Errors</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '3.paired-t';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Univeriate Repeated-measures ANOVA" href="4.univariate-anova.html" />
    <link rel="prev" title="Traditional Approaches to Repeated Measurements" href="2.traditional-approaches.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Linear Models with Correlated Errors - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Linear Models with Correlated Errors - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.correlation-problem.html">The Problem of Correlated Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.traditional-approaches.html">Traditional Approaches to Repeated Measurements</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">The Paired <span class="math notranslate nohighlight">\(t\)</span>-test</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.univariate-anova.html">The Univeriate Repeated-measures ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.multivariate-anova.html">The Multivariate Repeated-measures ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.mixed-effects.html">Introducing Mixed-effects Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary and Quiz</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors/issues/new?title=Issue%20on%20page%20%2F3.paired-t.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/3.paired-t.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Paired t-test</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-paired-t-test-as-a-linear-model">The Paired <span class="math notranslate nohighlight">\(t\)</span>-test as a Linear Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-t-test-as-an-lm">Two-sample <span class="math notranslate nohighlight">\(t\)</span>-test as an LM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-sources">Variance Sources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recreating-the-paired-t-test-in-the-linear-model">Recreating the Paired <span class="math notranslate nohighlight">\(t\)</span>-test in the Linear Model</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-paired-t-test">
<h1>The Paired <span class="math notranslate nohighlight">\(t\)</span>-test<a class="headerlink" href="#the-paired-t-test" title="Link to this heading">#</a></h1>
<p>To begin, let us examine the difference in results between a <em>two-sample</em> <span class="math notranslate nohighlight">\(t\)</span>-test and a <em>paired</em> <span class="math notranslate nohighlight">\(t\)</span>-test. To do this, we can simulate data as we did before and then use the <code class="docutils literal notranslate"><span class="pre">t.test()</span></code> function with the <code class="docutils literal notranslate"><span class="pre">paired</span></code> option set to either <code class="docutils literal notranslate"><span class="pre">TRUE</span></code> or <code class="docutils literal notranslate"><span class="pre">FALSE</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">666</span><span class="p">)</span>

<span class="n">var1</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="n">var2</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="n">rho</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.8</span>
<span class="n">covar</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rho</span><span class="o">*</span><span class="n">var1</span><span class="o">*</span><span class="n">var2</span>

<span class="n">Sigma</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="n">covar</span><span class="p">,</span><span class="n">covar</span><span class="p">,</span><span class="n">var2</span><span class="p">),</span><span class="w"> </span><span class="n">nrow</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="n">y</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mvrnorm</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">mu</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1.25</span><span class="p">),</span><span class="w"> </span><span class="n">Sigma</span><span class="o">=</span><span class="n">Sigma</span><span class="p">)</span>

<span class="nf">t.test</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">paired</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">var.equal</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">t.test</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">y</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">paired</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w">  </span><span class="n">var.equal</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Two Sample t-test

data:  y[, 1] and y[, 2]
t = -0.92759, df = 98, p-value = 0.3559
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.6487683  0.2354578
sample estimates:
mean of x mean of y 
0.9601951 1.1668504 
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Paired t-test

data:  y[, 1] and y[, 2]
t = -2.4952, df = 49, p-value = 0.01601
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.3730884 -0.0402221
sample estimates:
mean difference 
     -0.2066553 
</pre></div>
</div>
</div>
</div>
<p>Perhaps the first thing you will notice is that the two-sample <span class="math notranslate nohighlight">\(t\)</span>-test is <em>non-significant</em>, whereas the paired <span class="math notranslate nohighlight">\(t\)</span>-test is <em>significant</em>. However, there is more to unpack here.</p>
<p>Firstly, the output from the <em>two-sample</em> test reports the estimated group means as <span class="math notranslate nohighlight">\(\hat{\mu}_{1} = 0.9601951\)</span> and <span class="math notranslate nohighlight">\(\hat{\mu}_{2} = 1.1668504\)</span>, meaning that the estimated mean difference is <span class="math notranslate nohighlight">\(\hat{\mu}_{1} - \hat{\mu}_{2} = 1.090923 - 1.303266 = -0.2066553\)</span>. This is the same as reported by the <em>paired</em> test. As such, the difference between these methods has nothing to do with the estimated mean difference, as this is <em>identical</em>.</p>
<p>Where the two tests differ can be seen in terms of the <span class="math notranslate nohighlight">\(t\)</span>-statistic itself, the degrees of freedom and the confidence interval. Remembering that the structure of a <span class="math notranslate nohighlight">\(t\)</span>-statistic is</p>
<div class="math notranslate nohighlight">
\[
t = \frac{\mu_{1} - \mu_{2}}{\text{SE}\{\mu_{1} - \mu_{2}\}}
\]</div>
<p>we think of the test statistic as dividing the mean difference by the standard error of the difference. If the numerator of the test statistic is the same under both the <em>two-sample</em> and <em>paired</em> tests, then the difference in results <em>must</em> be coming from a difference in the denominator. In other words, the standard error of the difference changes between the two-sample and paired cases.</p>
<p>This should not be a surprise, given the discussion earlier in this lesson. If the correlation is <em>positive</em>, then we expect the standard error of the difference to be <em>smaller</em> when the data are correlated. Indeed, this is what we see here. In both cases, we can recover the standard error by dividing the mean difference by the <span class="math notranslate nohighlight">\(t\)</span>-statistic. This gives</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">-0.2066553</span><span class="o">/</span><span class="m">-0.92759</span><span class="p">,</span><span class="w"> </span><span class="m">-0.2066553</span><span class="o">/</span><span class="m">-2.4952</span><span class="p">),</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.223</li><li>0.083</li></ol>
</div></div>
</div>
<p>So, in the <em>two-sample</em> case the standard error is <span class="math notranslate nohighlight">\(0.223\)</span>, which is larger than the standard error in the <em>paired</em> case, which is <span class="math notranslate nohighlight">\(0.083\)</span>. Again, this should not be a surprise and the conclusion here would be that the estimate in the <em>two-sample</em> case is <em>too large</em>, given the correlation in the data. However, the question for us here is really about <em>how</em> the <em>paired</em> <span class="math notranslate nohighlight">\(t\)</span>-test is able to take this into account.</p>
<section id="the-paired-t-test-as-a-linear-model">
<h2>The Paired <span class="math notranslate nohighlight">\(t\)</span>-test as a Linear Model<a class="headerlink" href="#the-paired-t-test-as-a-linear-model" title="Link to this heading">#</a></h2>
<p>To begin understanding how this works, it is useful to reframe the <span class="math notranslate nohighlight">\(t\)</span>-test in terms of a linear model.</p>
<section id="two-sample-t-test-as-an-lm">
<h3>Two-sample <span class="math notranslate nohighlight">\(t\)</span>-test as an LM<a class="headerlink" href="#two-sample-t-test-as-an-lm" title="Link to this heading">#</a></h3>
<p>To see this, we first start with the familiar case of the <em>two-sample</em> model. We can fit this as an LM within <code class="docutils literal notranslate"><span class="pre">R</span></code> as follows</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">matrixcalc</span><span class="p">)</span>

<span class="n">y.long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">vec</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="w">          </span><span class="c1"># Turn y into a column</span>
<span class="n">cond</span><span class="w">   </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;A&quot;</span><span class="p">,</span><span class="s">&quot;B&quot;</span><span class="p">),</span><span class="m">50</span><span class="p">)</span><span class="w"> </span><span class="c1"># Create a predictor for the two conditions</span>

<span class="n">two.sample.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y.long</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">cond</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">two.sample.mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = y.long ~ cond)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.52090 -0.85738  0.01796  0.70661  2.41932 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.9602     0.1575   6.095 2.16e-08 ***
condB         0.2067     0.2228   0.928    0.356    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 1.114 on 98 degrees of freedom
Multiple R-squared:  0.008703,	Adjusted R-squared:  -0.001412 
F-statistic: 0.8604 on 1 and 98 DF,  p-value: 0.3559
</pre></div>
</div>
</div>
</div>
<p>Focussing on the coefficient and tests associated with <code class="docutils literal notranslate"><span class="pre">CondB</span></code> in the table, we can see <span class="math notranslate nohighlight">\(t = 0.928\)</span> and <span class="math notranslate nohighlight">\(p = 0.356\)</span>, which is the same<a class="footnote-reference brackets" href="#foot1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> as we saw for the two-sample test earlier. We can also see that the degrees of freedom agree at <span class="math notranslate nohighlight">\(98\)</span>. So we have managed to successfully implement the <em>two-sample</em> <span class="math notranslate nohighlight">\(t\)</span>-test as a linear model.</p>
<p>Now, we know that this is <em>incorrect</em> for correlated data. However, specifying the model in this form allows us to dig deeper into <em>why</em> this is wrong, which will then provide us with the insight needed to correct this and thus tell us how the <em>paired</em> method is able to accommodate correlation. This will also provide us with the grounding needed to understand the traditional repeated measured ANOVA, as well as mixed-effect model a little later in the unit.</p>
</section>
<section id="variance-sources">
<h3>Variance Sources<a class="headerlink" href="#variance-sources" title="Link to this heading">#</a></h3>
</section>
<section id="recreating-the-paired-t-test-in-the-linear-model">
<h3>Recreating the Paired <span class="math notranslate nohighlight">\(t\)</span>-test in the Linear Model<a class="headerlink" href="#recreating-the-paired-t-test-in-the-linear-model" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">subject</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">50</span><span class="p">),</span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">50</span><span class="p">)),</span><span class="w"> </span><span class="n">nrow</span><span class="o">=</span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="n">subject</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">vec</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">subject</span><span class="p">))</span>
<span class="n">subject</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>

<span class="n">paired.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y.long</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">cond</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">subject</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">paired.mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = y.long ~ cond + subject)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.9091 -0.1826  0.0000  0.1826  0.9091 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.736326   0.295727   5.871 3.69e-07 ***
condB        0.206655   0.082820   2.495 0.016005 *  
subject2     1.196331   0.414100   2.889 0.005741 ** 
subject3    -1.051564   0.414100  -2.539 0.014328 *  
subject4     1.209435   0.414100   2.921 0.005268 ** 
subject5    -2.817765   0.414100  -6.805 1.33e-08 ***
subject6     0.004824   0.414100   0.012 0.990752    
subject7    -1.953810   0.414100  -4.718 2.02e-05 ***
subject8    -1.475991   0.414100  -3.564 0.000825 ***
subject9    -2.414923   0.414100  -5.832 4.25e-07 ***
subject10   -0.754529   0.414100  -1.822 0.074547 .  
subject11    1.325056   0.414100   3.200 0.002413 ** 
subject12   -2.394042   0.414100  -5.781 5.08e-07 ***
subject13    0.105629   0.414100   0.255 0.799729    
subject14   -2.346537   0.414100  -5.667 7.61e-07 ***
subject15   -0.587411   0.414100  -1.419 0.162367    
subject16   -0.786589   0.414100  -1.900 0.063391 .  
subject17    0.099602   0.414100   0.241 0.810926    
subject18   -0.387452   0.414100  -0.936 0.354043    
subject19   -1.267217   0.414100  -3.060 0.003583 ** 
subject20    0.031173   0.414100   0.075 0.940299    
subject21   -1.371237   0.414100  -3.311 0.001748 ** 
subject22   -1.836987   0.414100  -4.436 5.18e-05 ***
subject23    0.489084   0.414100   1.181 0.243274    
subject24   -1.011166   0.414100  -2.442 0.018269 *  
subject25   -0.685651   0.414100  -1.656 0.104162    
subject26   -2.120863   0.414100  -5.122 5.09e-06 ***
subject27   -1.783486   0.414100  -4.307 7.93e-05 ***
subject28   -2.387982   0.414100  -5.767 5.34e-07 ***
subject29   -1.722743   0.414100  -4.160 0.000128 ***
subject30   -1.988735   0.414100  -4.803 1.52e-05 ***
subject31    0.001599   0.414100   0.004 0.996935    
subject32   -1.323223   0.414100  -3.195 0.002444 ** 
subject33    0.643038   0.414100   1.553 0.126893    
subject34   -1.307154   0.414100  -3.157 0.002730 ** 
subject35   -0.497410   0.414100  -1.201 0.235455    
subject36   -0.464979   0.414100  -1.123 0.266967    
subject37   -0.307461   0.414100  -0.742 0.461341    
subject38   -2.122708   0.414100  -5.126 5.01e-06 ***
subject39   -0.543883   0.414100  -1.313 0.195163    
subject40    1.240640   0.414100   2.996 0.004283 ** 
subject41   -0.026287   0.414100  -0.063 0.949642    
subject42   -1.178307   0.414100  -2.845 0.006457 ** 
subject43   -1.173931   0.414100  -2.835 0.006642 ** 
subject44    1.036230   0.414100   2.502 0.015723 *  
subject45   -0.225670   0.414100  -0.545 0.588250    
subject46   -1.772234   0.414100  -4.280 8.66e-05 ***
subject47   -1.008887   0.414100  -2.436 0.018518 *  
subject48   -0.627914   0.414100  -1.516 0.135860    
subject49   -0.103401   0.414100  -0.250 0.803864    
subject50   -0.359054   0.414100  -0.867 0.390129    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.4141 on 49 degrees of freedom
Multiple R-squared:  0.9315,	Adjusted R-squared:  0.8616 
F-statistic: 13.33 on 50 and 49 DF,  p-value: 2.636e-16
</pre></div>
</div>
</div>
</div>
<p>Now, the output here is a bit of mess due to all the subject effects. However, if you look at the coefficient and test for <code class="docutils literal notranslate"><span class="pre">CondB</span></code>, notice that <span class="math notranslate nohighlight">\(t = 2.495\)</span> and <span class="math notranslate nohighlight">\(p = 0.016\)</span>, which is the same as the <em>paired</em> <span class="math notranslate nohighlight">\(t\)</span>-test from earlier. Furthermore, the degrees of freedom are now correct at <span class="math notranslate nohighlight">\(49\)</span>. As such, adding the subject effects to the model has allowed the <em>between-subjects</em> error to be partitioned out and thus the remaining variance calculated from the residuals is <em>only</em> the <em>within-subject</em> error. This is the error needed to correctly estimate the standard error of the paired difference and thus the model results are now correct.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[,</span><span class="m">1</span><span class="p">]),</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">[,</span><span class="m">2</span><span class="p">])),</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>0.9602</li><li>1.1669</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">beta</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">paired.mod</span><span class="p">)</span>
<span class="n">mu</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
<span class="n">mu</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w">           </span><span class="nf">sum</span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="m">51</span><span class="p">])</span><span class="o">/</span><span class="m">50</span><span class="w"> </span><span class="c1"># beta[1] = mu[1] + mean subject effect</span>
<span class="n">mu</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">beta</span><span class="p">[</span><span class="m">3</span><span class="o">:</span><span class="m">51</span><span class="p">])</span><span class="o">/</span><span class="m">50</span><span class="w"> </span><span class="c1"># beta[2] = mu[1] - mu[2] </span>
</pre></div>
</div>
</div>
</div>
<p>So from this, we can see that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\mu_{1} &amp;= \beta_{0} + \frac{1}{n}\sum_{k=2}^{n+1}\beta_{k} \\
\mu_{2} &amp;= \beta_{0} + \beta_{1} + \frac{1}{n}\sum_{k=2}^{n+1}\beta_{k}.
\end{align}
\end{split}\]</div>
<p>Solving for both <span class="math notranslate nohighlight">\(\beta_{0}\)</span> and <span class="math notranslate nohighlight">\(\beta_{1}\)</span> gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\beta_{0} &amp;= \mu_{1} - \frac{1}{n}\sum_{k=2}^{n+1}\beta_{k} \\
\beta_{1} &amp;= \beta_{0} + \frac{1}{n}\sum_{k=2}^{n+1}\beta_{k} - \mu_{2} = \mu_{1} - \mu_{2}.
\end{align}
\end{split}\]</div>
<p>So, rather unituitively, the intercept is actually the mean of the first group, minus the average of the subject effects. This then raises the question of what exactly the subject effects are? We can use a similar approach as above to solve for these. For instance, the expected value of the response from subject 2 in condition A is</p>
<div class="math notranslate nohighlight">
\[
\mu_{12} = \beta_{0} + \beta_{2}.
\]</div>
<p>Meaning that the effect for subject 2 is</p>
<div class="math notranslate nohighlight">
\[
\beta_{2} = \mu_{12} - \beta_{0}.
\]</div>
<p>As such, the subject effects are effectively <em>residuals</em> around the intercept. Importantly, these are <em>constant offsets</em>, irrespective of the condition. For instance. As such, subject 2 is expect to lie the same distance from the mean of condition A and the mean of condition B.</p>
<div class="warning dropdown admonition">
<p class="admonition-title">Advanced: Understanding the coefficients in the paired model</p>
<p>Boo!</p>
</div>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="foot1" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Due to the way the factors are coded in <code class="docutils literal notranslate"><span class="pre">R</span></code>, the coefficient is actually the opposite comparison here, hence why the <span class="math notranslate nohighlight">\(t\)</span>-statistic is <em>positive</em> rather than <em>negative</em>.</p>
</aside>
</aside>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="2.traditional-approaches.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Traditional Approaches to Repeated Measurements</p>
      </div>
    </a>
    <a class="right-next"
       href="4.univariate-anova.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The Univeriate Repeated-measures ANOVA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-paired-t-test-as-a-linear-model">The Paired <span class="math notranslate nohighlight">\(t\)</span>-test as a Linear Model</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#two-sample-t-test-as-an-lm">Two-sample <span class="math notranslate nohighlight">\(t\)</span>-test as an LM</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-sources">Variance Sources</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recreating-the-paired-t-test-in-the-linear-model">Recreating the Paired <span class="math notranslate nohighlight">\(t\)</span>-test in the Linear Model</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>