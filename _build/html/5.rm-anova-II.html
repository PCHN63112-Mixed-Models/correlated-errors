
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Higher-order Repeated Measures ANOVA &#8212; Linear Models with Correlated Errors</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=a80109f0" />
    <link rel="stylesheet" type="text/css" href="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rgl.css?v=57907efa" />
    <link rel="stylesheet" type="text/css" href="_static/sphericity_3d_files/htmltools-fill-0.5.8.1/fill.css?v=971cc1da" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '5.rm-anova-II';</script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/textures.src.js?v=9482728f"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/shadersrc.src.js?v=6ce05c17"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/buffer.src.js?v=1efca185"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/mouse.src.js?v=96f0b970"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/projection.src.js?v=98871b91"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/axes.src.js?v=3250d244"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rglTimer.src.js?v=ac1c3151"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/pretty.src.js?v=4f2cffba"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/shaders.src.js?v=bbbdf37d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/animation.src.js?v=74f9b9e8"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/pieces.src.js?v=280fd571"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/selection.src.js?v=5b47ed7d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/init.src.js?v=f5bdcbbb"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/subscenes.src.js?v=42cb429d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/controls.src.js?v=4b3dbe6f"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/draw.src.js?v=49d9cbaa"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/utils.src.js?v=56efe719"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rglClass.src.js?v=9e593197"></script>
    <script src="_static/sphericity_3d_files/rglWebGL-binding-1.3.18/rglWebGL.js?v=8cd6f6d7"></script>
    <script src="_static/sphericity_3d_files/htmlwidgets-1.6.4/htmlwidgets.js?v=175713be"></script>
    <script src="_static/sphericity_3d_files/CanvasMatrix4-1.3.18/CanvasMatrix.src.js?v=5a2d04be"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Summary" href="summary.html" />
    <link rel="prev" title="One-way Repeated Measures ANOVA" href="4.rm-anova-I.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Linear Models with Correlated Errors - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Linear Models with Correlated Errors - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.designs.html">Repeated Measurements</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.probability.html">Probability Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.paired-t.html">The Paired <em>t</em>-test</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.rm-anova-I.html">One-way Repeated Measures ANOVA</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Higher-order Repeated Measures ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors/issues/new?title=Issue%20on%20page%20%2F5.rm-anova-II.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/5.rm-anova-II.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Higher-order Repeated Measures ANOVA</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-between-subjects-factors">Adding Between-subjects Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-between-subjects-error-term">The Between-subjects Error Term</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-between-subjects-error-in-r">Specifying Between-subjects Error in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-more-within-subject-factors">Adding More Within-subject Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-within-subject-error-terms">Multiple Within-subject Error Terms</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-bother-with-the-repeated-measures-anova">Why Bother with the Repeated Measures ANOVA?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="higher-order-repeated-measures-anova">
<h1>Higher-order Repeated Measures ANOVA<a class="headerlink" href="#higher-order-repeated-measures-anova" title="Link to this heading">#</a></h1>
<p>In the previous part of this lesson, we examined the most simple case of the repeated measures ANOVA. Despite the simplicity of the design, we saw how this analysis had several complications around the correct partition of the error, as well as the assumptions made about the covariance structure. These alone were enough to suggest that the repeated measures ANOVA framework was problematic to apply in practice. Yet, there are even more complex situations where this framework can be applied. In this final part of the lesson, we will see how the repeated measures ANOVA is used in situations where there are additional <em>between-subjects</em> factors, as well as multiple <em>within-subject</em> factors. This is not to condone the use of the repeated measures ANOVA in these situations, rather it is to help you understand (a) how the repeated measures ANOVA generalises and (b) why an approach method such as mixed-effects will provide a better alternative.</p>
<section id="adding-between-subjects-factors">
<h2>Adding Between-subjects Factors<a class="headerlink" href="#adding-between-subjects-factors" title="Link to this heading">#</a></h2>
<p>The first additional complexity we may come across is when we have a <em>between-subjects</em> factor alongside the repeated measurements. For example, the <code class="docutils literal notranslate"><span class="pre">datarium</span></code> package contains the dataset <code class="docutils literal notranslate"><span class="pre">anxiety</span></code>. Here, repeated measurements of anxiety have been taken at 3 different time points. The 45 subjects are split between 3 different exercise regimes and the experimental question concerns the relationship between exercise and time on anxiety. So, <code class="docutils literal notranslate"><span class="pre">time</span></code> is the repeated measurement and <code class="docutils literal notranslate"><span class="pre">group</span></code> is the between-subjects factor. This is effectively a <span class="math notranslate nohighlight">\(3 \times 3\)</span> ANOVA, as illustrated in the table below.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Group: Low</p></th>
<th class="head"><p>Group: Moderate</p></th>
<th class="head"><p>Group: High</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Time: 1</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{12}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{13}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Time: 2</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{21}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{22}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{23}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>Time: 3</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{31}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{32}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{33}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>As such, our interest falls on the main effect of <code class="docutils literal notranslate"><span class="pre">group</span></code>, main effect of <code class="docutils literal notranslate"><span class="pre">time</span></code> and the <code class="docutils literal notranslate"><span class="pre">group:time</span></code> interaction. Based on what we have covered do far, we can easily apply the following two-way ANOVA model with partitioned errors</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    y_{ijk}    &amp;=    \mu + \alpha_{j} + \beta_{k} + (\alpha\beta)_{jk} + S_{i} + \eta_{ijk} \\
    S_{i}      &amp;\sim \mathcal{N}(0,\sigma^{2}_{b}) \\ 
    \eta_{ijk} &amp;\sim \mathcal{N}(0,\sigma^{2}_{w})
\end{alignat*}
\end{split}\]</div>
<p>Here we have added a term for the <em>between-subject</em> effect (denoted <span class="math notranslate nohighlight">\(\beta_{k}\)</span>), as well as the <em>between</em> <span class="math notranslate nohighlight">\(\times\)</span> <em>within</em> interaction (denoted <span class="math notranslate nohighlight">\((\alpha\beta)_{jk}\)</span>). So now <span class="math notranslate nohighlight">\(i\)</span> indexes the subject (<span class="math notranslate nohighlight">\(i = 1,\dots,45\)</span>), <span class="math notranslate nohighlight">\(j\)</span> indexes the repeated measurements (<span class="math notranslate nohighlight">\(j = 1,\dots,3\)</span>) and <span class="math notranslate nohighlight">\(k\)</span> indexes the groups (<span class="math notranslate nohighlight">\(k = 1,\dots,3\)</span>).</p>
<p>We can see this dataset below in its original form</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;datarium&#39;</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="s">&#39;anxiety&#39;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">anxiety</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  id group   t1   t2   t3
1  1  grp1 14.1 14.4 14.1
2  2  grp1 14.5 14.6 14.3
3  3  grp1 15.7 15.2 14.9
4  4  grp1 16.0 15.5 15.3
5  5  grp1 16.5 15.8 15.7
6  6  grp1 16.9 16.5 16.2
</pre></div>
</div>
</div>
</div>
<p>and then reworked into long-format for univariate modelling</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;reshape2&#39;</span><span class="p">)</span>

<span class="c1"># repeats and number of subjects</span>
<span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">3</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">45</span>

<span class="c1"># reshape wide -&gt; long</span>
<span class="n">anxiety.long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">melt</span><span class="p">(</span><span class="n">anxiety</span><span class="p">,</span><span class="w">                 </span><span class="c1"># wide data frame</span>
<span class="w">                     </span><span class="n">id.vars</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span><span class="s">&#39;group&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1"># what stays fixed?</span>
<span class="w">                     </span><span class="n">variable.name</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">,</span><span class="w">    </span><span class="c1"># name for the new predictor</span>
<span class="w">                     </span><span class="n">value.name</span><span class="o">=</span><span class="s">&#39;anxiety&#39;</span><span class="p">)</span><span class="w">    </span><span class="c1"># name for the new outcome</span>

<span class="n">anxiety.long</span><span class="w">           </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">anxiety.long</span><span class="w"> </span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">anxiety.long</span><span class="o">$</span><span class="n">id</span><span class="p">),]</span><span class="w"> </span><span class="c1"># order by ID</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">anxiety.long</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="w">                             </span><span class="c1"># fix row names</span>
<span class="n">anxiety.long</span><span class="o">$</span><span class="n">id</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">anxiety.long</span><span class="o">$</span><span class="n">id</span><span class="p">)</span><span class="w">             </span><span class="c1"># id as factor</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">anxiety.long</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  id group time anxiety
1  1  grp1   t1    14.1
2  1  grp1   t2    14.4
3  1  grp1   t3    14.1
4  2  grp1   t1    14.5
5  2  grp1   t2    14.6
6  2  grp1   t3    14.3
</pre></div>
</div>
</div>
</div>
<p>So far, nothing has changed from what we have seen previously. However, we now have to think more carefully about our possible error terms and which is most sensible to use as the denominator for each test.</p>
<section id="the-between-subjects-error-term">
<h3>The Between-subjects Error Term<a class="headerlink" href="#the-between-subjects-error-term" title="Link to this heading">#</a></h3>
<p>Recall from the previous part of this lesson that a repeated measures ANOVA is effectively a linear model with <em>partitioned errors</em>. We stated earlier that by splitting the errors into <span class="math notranslate nohighlight">\(\epsilon_{ijk} = S_{i} + \eta_{ijk}\)</span> we are effectively specifying a model with <em>two</em> variance terms. So, the variance function becomes</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(y_{ijk}) = \sigma^{2} = \sigma^{2}_{b} + \sigma^{2}_{w}.
\]</div>
<p>The point of doing this was two-fold. Firstly, it <em>removes</em> the correlation from the model errors and thus the model now meets the <span class="math notranslate nohighlight">\(i.i.d.\)</span> assumptions. Secondly, it removes error variance associated with the differences <em>between</em> the subjects, allowing any inferential tests to only use the variance associated with measurements <em>within</em> a subject. This is obviously the most suitable error to use for inference on the repeated measures because it captures the random fluctuations in measurements <em>within</em> an individual.</p>
<p>Conceptually, the repeated measurements from subject <span class="math notranslate nohighlight">\(i\)</span> can be considered multiple draws from a distribution with a variance <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> and a mean <span class="math notranslate nohighlight">\(E(y_{ij}) = \mu_{j} + S_{i}\)</span>. The distribution of each subject is therefore conceptualised as having the <em>same</em> variance but a <em>different</em> mean, unique to each subject. These means are then further conceptualised as random draws from a larger distribution of <em>different subjects</em> with a variance <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span>. Thus, the variation <em>between</em> subjects is represented by this larger distribution, whereas as the variation <em>within</em> each subject is represented by the smaller individual distributions. This is illustrated in <a class="reference internal" href="#mixed-sampling-fig"><span class="std std-numref">Fig. 4</span></a> for two group-level distributions.</p>
<figure class="align-default" id="mixed-sampling-fig">
<a class="reference internal image-reference" href="_images/mixed-measures-sampling.png"><img alt="_images/mixed-measures-sampling.png" src="_images/mixed-measures-sampling.png" style="width: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">An illustration of the sampling model that underlies a repeated measures design with 3 measurements per-subject, as taken from 2 independent groups. Two example subjects are shown for each group. The most important element here is seeing the different variance sources (<span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span> and <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>) and how these correspond to inference for either the between-subjects or within-subject effects.</span><a class="headerlink" href="#mixed-sampling-fig" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Importantly, we need to think about which measure of <em>uncertainty</em> is most suitable for inference about the different elements of this sampling model. For the repeated measurements, we can see that these all come from distributions with variance <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. Thus, our uncertainty around our estimates of these effects is tied to how much we expect them to vary for each subject. This means that <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> is the most suitable error term. Now, in terms of looking at the <em>group</em> effects, we can see that these come from distributions with variance <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span>. These are distributions of the <em>subject means</em>, capturing how much the subjects differ from each other. This is parameterised in terms of the subject-specific errors given by <span class="math notranslate nohighlight">\(S_{i}\)</span>, which capture the magnitude of the discrepancy between each subject and the group average. Thus, the variance of the subject means is given by <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span>. Any inference about subjects <em>as a whole</em> needs to take the variability of the subjects into account. Thus, for inference about the group effects, <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span> is the most suitable error term. So, taking this all together, we now have a model where <em>different effects</em> require <em>different error terms</em>.</p>
</section>
<section id="specifying-between-subjects-error-in-r">
<h3>Specifying Between-subjects Error in <code class="docutils literal notranslate"><span class="pre">R</span></code><a class="headerlink" href="#specifying-between-subjects-error-in-r" title="Link to this heading">#</a></h3>
<p>As we established earlier, we can use <code class="docutils literal notranslate"><span class="pre">aov()</span></code> to express how we want the arithmetic of the ANOVA table to be organised. Again, this is a serious limitation of the repeated measures ANOVA because this requires some degree of manual intervention to state which terms we want treated as <em>error</em> and which we want treated as effects of interest. This can get complex very quickly and it is up to the analyst to indicate which terms are which<a class="footnote-reference brackets" href="#ems-foot" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>. For this example, the specification is fairly simple because we just denote the subject term as error and <code class="docutils literal notranslate"><span class="pre">aov()</span></code> will automatically arrange the tests for us</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">anxiety.aov</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">anxiety</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">Error</span><span class="p">(</span><span class="n">id</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">anxiety.long</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">anxiety.aov</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: id
          Df Sum Sq Mean Sq F value Pr(&gt;F)  
group      2  61.99  30.996   4.352 0.0192 *
Residuals 42 299.15   7.123                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: Within
           Df Sum Sq Mean Sq F value Pr(&gt;F)    
time        2  66.58   33.29   394.9 &lt;2e-16 ***
group:time  4  37.15    9.29   110.2 &lt;2e-16 ***
Residuals  84   7.08    0.08                   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>As we can see, the effect of <code class="docutils literal notranslate"><span class="pre">group</span></code> is now associated with <code class="docutils literal notranslate"><span class="pre">Error:</span> <span class="pre">id</span></code>, which represents the estimate of <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span>. The effect of <code class="docutils literal notranslate"><span class="pre">time</span></code> remains associated with <code class="docutils literal notranslate"><span class="pre">Error:</span> <span class="pre">Within</span></code>, which represents the estimate of <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. Notice as well that the interaction term <code class="docutils literal notranslate"><span class="pre">group:time</span></code> also uses <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. This may seem puzzling, given that this contains a comparison <em>across</em> the groups. However, remember that when calculating the variance of the difference between two random variables, the covariance is subtracted. Because <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span> also acts as the covariance, it cancels-out when comparing the repeated measurements and thus cancels-out when calculating the interaction.</p>
<p>We can also calculate the above using <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code>, without having to explicitly specify the error terms, as shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;ez&#39;</span><span class="p">)</span>
<span class="n">anxiety.ez</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ezANOVA</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">anxiety.long</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="o">=</span><span class="n">anxiety</span><span class="p">,</span><span class="w"> </span><span class="n">wid</span><span class="o">=</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">within</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">between</span><span class="o">=</span><span class="n">group</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">anxiety.ez</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>$ANOVA
      Effect DFn DFd          F            p p&lt;.05       ges
2      group   2  42   4.351811 1.916093e-02     * 0.1683558
3       time   2  84 394.909490 1.905584e-43     * 0.1785886
4 group:time   4  84 110.187610 1.384653e-32     * 0.1081997

$`Mauchly&#39;s Test for Sphericity`
      Effect         W          p p&lt;.05
3       time 0.8836439 0.07919252      
4 group:time 0.8836439 0.07919252      

$`Sphericity Corrections`
      Effect       GGe        p[GG] p[GG]&lt;.05       HFe        p[HF] p[HF]&lt;.05
3       time 0.8957715 3.484600e-39         * 0.9330916 1.037156e-40         *
4 group:time 0.8957715 1.966104e-29         * 0.9330916 1.461019e-30         *
</pre></div>
</div>
</div>
</div>
<p>Although both the above approaches are reasonably simple to specify, it is worth considering the implications of getting this <em>wrong</em>. To see this, let us specify this model using <code class="docutils literal notranslate"><span class="pre">lm()</span></code> and then look at the traditional ANOVA table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">anxiety.wrong.lm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">anxiety</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">anxiety.long</span><span class="p">)</span>
<span class="nf">anova</span><span class="p">(</span><span class="n">anxiety.wrong.lm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Analysis of Variance Table

Response: anxiety
           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
group       2  61.992  30.996 367.701 &lt; 2.2e-16 ***
time        2  66.579  33.289 394.909 &lt; 2.2e-16 ***
id         42 299.146   7.123  84.494 &lt; 2.2e-16 ***
group:time  4  37.154   9.288 110.188 &lt; 2.2e-16 ***
Residuals  84   7.081   0.084                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>Without any further information, both <code class="docutils literal notranslate"><span class="pre">lm()</span></code> and <code class="docutils literal notranslate"><span class="pre">anova()</span></code> treat every term in the formula as part of the <em>mean function</em> and thus assumes we are interested in each term for the purpose of inference. As we saw earlier, we can just ignore the tests on <code class="docutils literal notranslate"><span class="pre">id</span></code>. Its inclusion has partitioned <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span> out from <span class="math notranslate nohighlight">\(\sigma^{2}\)</span>, meaning that the <code class="docutils literal notranslate"><span class="pre">Residuals</span></code> term in the ANOVA table only represents <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. This is fine for both the test on <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">group:time</span></code>, which are no different to the tests produced by <code class="docutils literal notranslate"><span class="pre">aov()</span></code>. However, the crucial difference comes from the test of <code class="docutils literal notranslate"><span class="pre">group</span></code>. Notice that the <em>correct</em> test has <span class="math notranslate nohighlight">\(F = 4.35\)</span>, whereas the test above has <span class="math notranslate nohighlight">\(F = 367.70\)</span>. This is approximately 85 times <em>larger</em>! Such a huge discrepancy comes from the fact that the <em>incorrect</em> test is using <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> as the denominator, which is <em>much smaller</em> than <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span>. This makes the test <em>far too liberal</em>.</p>
<p>Although both versions of this test are still “significant”, it is not hard to imagine a situation where you could get a significant effect of <code class="docutils literal notranslate"><span class="pre">group</span></code> simply by specifying the wrong error. Getting this wrong could be disastrous because we might falsely claim that the between-subjects factor has an effect when it does not. Considering that these factors may correspond to something like patients vs controls, concluding a false difference could have serious implications.</p>
<p>We could also get this “wrong” by not partitioning the error at all and instead working with a <em>pooled</em> error of <span class="math notranslate nohighlight">\(\sigma^{2}_{b} + \sigma^{2}_{w}\)</span> for every test. An example of this is shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">anxiety.pooled.lm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">anxiety</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="o">*</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">anxiety.long</span><span class="p">)</span>
<span class="nf">anova</span><span class="p">(</span><span class="n">anxiety.pooled.lm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Analysis of Variance Table

Response: anxiety
            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
group        2  61.992  30.996 12.7536 9.038e-06 ***
time         2  66.579  33.289 13.6973 4.143e-06 ***
group:time   4  37.154   9.288  3.8218  0.005753 ** 
Residuals  126 306.227   2.430                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>Notice that, by not acknowledging or accommodating the correlation or different variance sources, many of the tests have got <em>substantially</em> weaker. So we have <code class="docutils literal notranslate"><span class="pre">time</span></code>: <span class="math notranslate nohighlight">\(F = 394.9 \rightarrow 13.70\)</span> and <code class="docutils literal notranslate"><span class="pre">time:group</span></code>: <span class="math notranslate nohighlight">\(F = 110.2 \rightarrow 3.82\)</span>. So, by not doing this at all, we kill the power advantage of having a repeated measures experiment in the first place.</p>
</section>
</section>
<section id="adding-more-within-subject-factors">
<h2>Adding More Within-subject Factors<a class="headerlink" href="#adding-more-within-subject-factors" title="Link to this heading">#</a></h2>
<p>If all of the above was not bad enough, things get even trickier when we add <em>more</em> within-subject factors. We will not dwell on this too much because, as should be clear by now, we do not condone using the repeated measures ANOVA at all. However, this will provide the final clearest demonstration of <em>why</em> we want a much better framework for these type of data. The complexity demonstrated below is there to help you understand why you really do <em>not</em> want to do this. This is one of clearest cases where the automation provided by software such as SPSS actively <em>hides</em> so much of the complexity that researchers do not think twice about designing studies that require these methods.</p>
<p>As our example, the <code class="docutils literal notranslate"><span class="pre">datarium</span></code> package contains a dataset called <code class="docutils literal notranslate"><span class="pre">weightloss</span></code> that represents a fully within-subject <span class="math notranslate nohighlight">\(2 \times 2 \times 3\)</span> design. There were 12 subjects whose weight was measured under combination of <code class="docutils literal notranslate"><span class="pre">diet</span></code> (<code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code>) and <code class="docutils literal notranslate"><span class="pre">exercises</span></code> (<code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code>). For each combination of <code class="docutils literal notranslate"><span class="pre">diet</span></code> and <code class="docutils literal notranslate"><span class="pre">exercises</span></code>, the trial lasted 9 weeks, with measurements taken at 3 time-points. As such, every subject has 12 repeated measurements, representing every combination of <code class="docutils literal notranslate"><span class="pre">diet</span></code> and <code class="docutils literal notranslate"><span class="pre">exercises</span></code> across 3 values of <code class="docutils literal notranslate"><span class="pre">time</span></code>. The original dataset is shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;datarium&#39;</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="s">&#39;weightloss&#39;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">weightloss</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-C246"># A tibble: 6 × 6</span>
  id    diet  exercises    t1    t2    t3
  <span class=" -Color -Color-C246">&lt;fct&gt;</span> <span class=" -Color -Color-C246">&lt;fct&gt;</span> <span class=" -Color -Color-C246">&lt;fct&gt;</span>     <span class=" -Color -Color-C246">&lt;dbl&gt;</span> <span class=" -Color -Color-C246">&lt;dbl&gt;</span> <span class=" -Color -Color-C246">&lt;dbl&gt;</span>
<span class=" -Color -Color-C250">1</span> 1     no    no         10.4 13.2   11.6
<span class=" -Color -Color-C250">2</span> 2     no    no         11.6 10.7   13.2
<span class=" -Color -Color-C250">3</span> 3     no    no         11.4 11.1   11.4
<span class=" -Color -Color-C250">4</span> 4     no    no         11.1  9.5   11.1
<span class=" -Color -Color-C250">5</span> 5     no    no          9.5  9.73  12.3
<span class=" -Color -Color-C250">6</span> 6     no    no          9.5 12.7   10.4
</pre></div>
</div>
</div>
</div>
<p>and again after conversion to long format</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;reshape2&#39;</span><span class="p">)</span>

<span class="c1"># repeats and number of subjects</span>
<span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="c1"># 2 * 2 * 3</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">12</span>

<span class="c1"># reshape wide -&gt; long</span>
<span class="n">weightloss.long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">melt</span><span class="p">(</span><span class="n">weightloss</span><span class="p">,</span><span class="w">                         </span><span class="c1"># wide data frame</span>
<span class="w">                        </span><span class="n">id.vars</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span><span class="s">&#39;diet&#39;</span><span class="p">,</span><span class="s">&#39;exercises&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1"># what stays fixed?</span>
<span class="w">                        </span><span class="n">variable.name</span><span class="o">=</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="w">               </span><span class="c1"># name for the new predictor</span>
<span class="w">                        </span><span class="n">value.name</span><span class="o">=</span><span class="s">&quot;weight&quot;</span><span class="p">)</span><span class="w">                </span><span class="c1"># name for the new outcome</span>

<span class="n">weightloss.long</span><span class="w">           </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">weightloss.long</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">weightloss.long</span><span class="o">$</span><span class="n">id</span><span class="p">),]</span><span class="w"> </span><span class="c1"># order by ID</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">weightloss.long</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="w">                                  </span><span class="c1"># fix row names</span>
<span class="n">weightloss.long</span><span class="o">$</span><span class="n">id</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">weightloss.long</span><span class="o">$</span><span class="n">id</span><span class="p">)</span><span class="w">               </span><span class="c1"># id as factor</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">weightloss.long</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  id diet exercises time weight
1  1   no        no   t1  10.43
2  1   no       yes   t1  11.12
3  1  yes        no   t1  10.20
4  1  yes       yes   t1  10.43
5  1   no        no   t2  13.21
6  1   no       yes   t2  12.51
</pre></div>
</div>
</div>
</div>
<section id="multiple-within-subject-error-terms">
<h3>Multiple Within-subject Error Terms<a class="headerlink" href="#multiple-within-subject-error-terms" title="Link to this heading">#</a></h3>
<p>In order to facilitate understanding what we have to do when there are multiple within-subject factors, let us start by specifying the same partitioned error model we used above with <code class="docutils literal notranslate"><span class="pre">aov()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">weightloss.aov</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">diet</span><span class="o">*</span><span class="n">exercises</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">Error</span><span class="p">(</span><span class="n">id</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">weightloss.long</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">weightloss.aov</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: id
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 11   27.1   2.463               

Error: Within
                     Df Sum Sq Mean Sq F value   Pr(&gt;F)    
diet                  1   5.11    5.11   4.069   0.0459 *  
exercises             1  71.16   71.16  56.647 1.03e-11 ***
time                  2 211.39  105.69  84.134  &lt; 2e-16 ***
diet:exercises        1  33.40   33.40  26.586 9.96e-07 ***
diet:time             2   2.42    1.21   0.963   0.3846    
exercises:time        2  67.43   33.72  26.839 2.25e-10 ***
diet:exercises:time   2  30.77   15.39  12.249 1.43e-05 ***
Residuals           121 152.01    1.26                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>In this scenario, <code class="docutils literal notranslate"><span class="pre">diet</span></code>, <code class="docutils literal notranslate"><span class="pre">exercises</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code> are all using the <em>same</em> within-subject error term. But is this appropriate? If we focus on <code class="docutils literal notranslate"><span class="pre">diet</span></code>, <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> will contain the variation associated with the different diet conditions within each subject, which is what we want. However, it will <em>also</em> contain variation associated with the different levels of <code class="docutils literal notranslate"><span class="pre">exercises</span></code> and the different levels of <code class="docutils literal notranslate"><span class="pre">time</span></code>. If our focus is <code class="docutils literal notranslate"><span class="pre">diet</span></code> alone, it seems inappropriate to include the uncertainty around <code class="docutils literal notranslate"><span class="pre">exercises</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>. Similarly, if we are interested in the <code class="docutils literal notranslate"><span class="pre">diet:time</span></code> interaction, <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> will contain variation associated with both <code class="docutils literal notranslate"><span class="pre">diet</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>, as we want, but it will <em>also</em> include variation associated with <code class="docutils literal notranslate"><span class="pre">exercises</span></code>. This additional variation is of no relevance if we are only interested in the <code class="docutils literal notranslate"><span class="pre">diet:time</span></code> effect. What this means is that whenever there are <em>multiple</em> within-subject factors, we can <em>further partition</em> <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> into more error terms that are more suitable for each of these effects.</p>
<p>Going back to <code class="docutils literal notranslate"><span class="pre">diet</span></code> as an example, the errors we want are only those associated with the different levels of <code class="docutils literal notranslate"><span class="pre">diet</span></code> for each subject. This means we want to <em>average-over</em> all other repeated measurements associated with both <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">exercises</span></code>. This can be achieved by specifying an <em>interaction</em> between the subject effects and the levels of <code class="docutils literal notranslate"><span class="pre">diet</span></code>. This will create subject-specific errors (just like <span class="math notranslate nohighlight">\(S_{i}\)</span>) for each level of <code class="docutils literal notranslate"><span class="pre">diet</span></code>. The variance from these errors will then reflect within-subject variation associated with <code class="docutils literal notranslate"><span class="pre">diet</span></code>, ignoring both <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">exercises</span></code>. If we continue this logic for all other terms, we get an error structure where we can partition <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> into further terms by taking all possible interactions between <code class="docutils literal notranslate"><span class="pre">subject</span></code> and the within-subject factors. Using <code class="docutils literal notranslate"><span class="pre">aov()</span></code>, this becomes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">weightloss.aov</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">diet</span><span class="o">*</span><span class="n">exercises</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                               </span><span class="nf">Error</span><span class="p">(</span><span class="n">id</span><span class="w">                </span><span class="o">+</span><span class="w"> </span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">diet</span><span class="w">           </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">exercises</span><span class="w">      </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">time</span><span class="w">           </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">exercises</span><span class="o">:</span><span class="n">time</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">exercises</span><span class="o">:</span><span class="n">diet</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">time</span><span class="o">:</span><span class="n">diet</span><span class="w">      </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">time</span><span class="o">:</span><span class="n">exercises</span><span class="o">:</span><span class="n">diet</span><span class="p">),</span><span class="w"> </span>
<span class="w">                        </span><span class="n">data</span><span class="o">=</span><span class="n">weightloss.long</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">weightloss.aov</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: id
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 11   27.1   2.463               

Error: id:diet
          Df Sum Sq Mean Sq F value Pr(&gt;F)  
diet       1  5.111   5.111   6.021  0.032 *
Residuals 11  9.337   0.849                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:exercises
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
exercises  1  71.16   71.16   58.93 9.65e-06 ***
Residuals 11  13.28    1.21                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:time
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
time       2 211.39  105.69   110.9 3.22e-12 ***
Residuals 22  20.96    0.95                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:exercises:time
               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
exercises:time  2  67.43   33.72   20.83 8.41e-06 ***
Residuals      22  35.62    1.62                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:diet:exercises
               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
diet:exercises  1  33.40   33.40   75.36 2.98e-06 ***
Residuals      11   4.88    0.44                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:diet:time
          Df Sum Sq Mean Sq F value Pr(&gt;F)
diet:time  2   2.42   1.210   0.603  0.556
Residuals 22  44.17   2.008               

Error: id:diet:exercises:time
                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
diet:exercises:time  2  30.77   15.39   14.25 0.000107 ***
Residuals           22  23.76    1.08                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>which is both hideous to specify, but also to interpret given that we now have <em>8</em> ANOVA tables to deal with! It would also be very easy to get this wrong by missing a term somewhere. Luckily, there is an easier way to write this using</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">aov</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">diet</span><span class="o">*</span><span class="n">exercises</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">Error</span><span class="p">(</span><span class="n">id</span><span class="o">/</span><span class="p">(</span><span class="n">diet</span><span class="o">*</span><span class="n">exercises</span><span class="o">*</span><span class="n">time</span><span class="p">)),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">weightloss.long</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>where the syntax <code class="docutils literal notranslate"><span class="pre">id/(diet*exercises*time)</span></code> can be read as a request to include the main effect of the term on the <em>left</em> of <code class="docutils literal notranslate"><span class="pre">/</span></code> alongside all possible interactions with the terms on the <em>right</em> of <code class="docutils literal notranslate"><span class="pre">/</span></code><a class="footnote-reference brackets" href="#nesting-foot" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. Importantly, only the <em>within-subject</em> factors appear in the <code class="docutils literal notranslate"><span class="pre">Error()</span></code> syntax because our aim is to further partition <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> and <em>not</em> <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span>.</p>
<p>In general, it is not recommended to use <code class="docutils literal notranslate"><span class="pre">aov()</span></code> like this. Not only is it <em>difficult</em> and prone to <em>mistakes</em>, but the output becomes unwieldly. A better approach, if you <em>must</em> use a repeated measures ANOVA, is the <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code> function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;ez&#39;</span><span class="p">)</span>
<span class="n">weightloss.ez</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ezANOVA</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">weightloss.long</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">wid</span><span class="o">=</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">within</span><span class="o">=</span><span class="nf">.</span><span class="p">(</span><span class="n">diet</span><span class="p">,</span><span class="n">exercises</span><span class="p">,</span><span class="n">time</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">weightloss.ez</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>$ANOVA
               Effect DFn DFd          F            p p&lt;.05        ges
2                diet   1  11   6.021440 3.202562e-02     * 0.02774675
3           exercises   1  11  58.928078 9.650954e-06     * 0.28434954
4                time   2  22 110.941583 3.218470e-12     * 0.54133853
5      diet:exercises   1  11  75.356051 2.980284e-06     * 0.15716889
6           diet:time   2  22   0.602562 5.561945e-01       0.01332945
7      exercises:time   2  22  20.825889 8.408790e-06     * 0.27352201
8 diet:exercises:time   2  22  14.246076 1.074451e-04     * 0.14663048

$`Mauchly&#39;s Test for Sphericity`
               Effect         W          p p&lt;.05
4                time 0.9833425 0.91944157      
6           diet:time 0.5493166 0.05001654      
7      exercises:time 0.6835227 0.14919857      
8 diet:exercises:time 0.9589434 0.81089547      

$`Sphericity Corrections`
               Effect       GGe        p[GG] p[GG]&lt;.05       HFe        p[HF] p[HF]&lt;.05
4                time 0.9836155 4.732515e-12         * 1.1960214 3.218470e-12         *
6           diet:time 0.6893303 5.008306e-01           0.7558161 5.144265e-01          
7      exercises:time 0.7596029 7.470601e-05         * 0.8559657 3.105108e-05         *
8 diet:exercises:time 0.9605626 1.395812e-04         * 1.1594775 1.074451e-04         *
</pre></div>
</div>
</div>
</div>
<p>The output will match the result of <code class="docutils literal notranslate"><span class="pre">aov()</span></code>, but in a much nicer format, with the additional advantage of the sphericity corrections. However, this approach does hide the fundamental difficulty with assigning tests to different error terms and thus hides much of the complexity and disadvantages of the repeated measures ANOVA framework. We also have the problem that, by going down this route, we have effectively thrown away the linear model framework we have been working so hard to build. We end up with an ANOVA table and nothing else.</p>
</section>
</section>
<section id="why-bother-with-the-repeated-measures-anova">
<h2>Why Bother with the Repeated Measures ANOVA?<a class="headerlink" href="#why-bother-with-the-repeated-measures-anova" title="Link to this heading">#</a></h2>
<p>Everything we have discussed above has really been an exercise in telling you why you really <em>do not want to use a repeated measures ANOVA</em>. All the unnecessary fiddling with different error terms and different tests is a complication that we could simply do without. In the past, this was the <em>only</em> way to deal with repeated measures, but that is no longer the case. Ultimately, the concept of multiple error terms and multiple sources of error variance are perfectly sound. Indeed, we will see that this is the basis of mixed-effects models. However, getting this to work within the linear models framework, and within the traditional ANOVA framework, is fraught with difficulties. The repeated measures ANOVA is a solution to this, but is really an <em>ad hoc</em> workaround for an analysis that is ill-suited for this framework. We can use software to hide much of this complexity, but that does not mean it goes away.</p>
<p>Even if we are ok generating the correct output using <code class="docutils literal notranslate"><span class="pre">R</span></code>, particularly with access to something like <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code>, we are still left with a method that has a number of meaningful restrictions. Perhaps most concerning is the assumption of compound symmetry, because this will almost never be true in real-world data. Yes we can use some sort of correction for this, but this correction only applies to the inferential tests (not the model) and remains a further <em>ad hoc</em> adjustment to make the framework <em>approximately</em> correct. This is somewhat unsatisfying, especially as we would much prefer a method where the covariance matrix could just be <em>estimated</em> from the data and be allowed to take on any form it likes. This is particularly true when the correlation between repeated measurements is <em>negative</em>, because the repeated measures ANOVA simply <em>does not allow this</em>. This is a point that very few people understand about the repeated measures ANOVA.</p>
<p>Taking all this together, we can conclude that the repeated measures ANOVA is tricky to understand, tricky to use correctly and largely inflexible. It is perhaps no wonder that statisticians abandoned this method decades ago. Indeed, notice the dates around when the sphericity corrections were published: 1959 and 1976. This gives you a hint about when these approaches were last being developed and studied in mathematical statistics. And yet, this is the method that has persisted in psychology until only relatively recently. Indeed, as alluded to already, you are likely to come across people still using the repeated measures ANOVA to this day. You may even work for some of them who will <em>insist</em> that you use a repeated measures ANOVA to analyse their data. In those situations, it is useful to (a) motivate the need for something better and (b) understand how to get the ANOVA results in <code class="docutils literal notranslate"><span class="pre">R</span></code>, if absolutely necessary. So, we do not condone the use of the repeated measures ANOVA, but we understand its place in psychology and also understand that there are times where you may need to see what the repeated measures ANOVA says, even if you do not wish to use it. Over the next few weeks, we will show you how to replace this framework with something much better in the form of <em>mixed-effects models</em>.</p>
<aside class="topic">
<p class="topic-title">What do you now know?</p>
<p>In this section, we have explored more complex repeated measures ANOVA models, including those with <em>between-subject</em> factors and those with <em>multiple</em> within-subject factors. After reading this section, you should have a good sense of :</p>
<ul class="simple">
<li><p>The concept that adding a between-subject factor introduces a choice of error terms for each test, where <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span> is most suitable for the between-subjects effects and <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> is most suitable for the within-subject effects.</p></li>
<li><p>The idea that we can indicate this in <code class="docutils literal notranslate"><span class="pre">R</span></code> either through the use of <code class="docutils literal notranslate"><span class="pre">aov()</span></code> with a suitable <code class="docutils literal notranslate"><span class="pre">Error()</span></code> specification, or through the use of <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code>.</p></li>
<li><p>The key notion that if we get this <em>wrong</em> then the tests of the between-subjects effects will be <em>too liberal</em> and we are liable to reach false conclusions.</p></li>
<li><p>The concept that adding multiple within-subject factors makes the error situation much more complex because we must further partition <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> using all possible interactions between the subject effects and the within-subject factors.</p></li>
<li><p>The idea that this can be performed using <code class="docutils literal notranslate"><span class="pre">aov()</span></code> and <code class="docutils literal notranslate"><span class="pre">Error()</span></code>, but that this can get complex to specify and is prone to mistakes.</p></li>
<li><p>The idea that it is much simpler to do so using <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code>, but this effectively throws-away the whole linear models framework.</p></li>
<li><p>The general conclusion that repeated measures ANOVAs are not a good method to use for repeated measurements due to a variety of complications and restrictions that are no longer necessary in modern statistics.</p></li>
</ul>
</aside>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="ems-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>There is a more principled way of determining the correct error term via calculation of something called the <em>expected mean squares</em> (EMS). However, this is an old topic that is not that relevant given that we are not suggesting you actually use the repeated measures ANOVA. If you are curious, the EMS are discussed at length by <a class="reference external" href="https://www.frontiersin.org/journals/neuroscience/articles/10.3389/fnins.2019.00352/full">McFarquhar (2019)</a> and can be calculated for you automatically by the <code class="docutils literal notranslate"><span class="pre">R</span></code> package <code class="docutils literal notranslate"><span class="pre">EMSaov</span></code>.</p>
</aside>
<aside class="footnote brackets" id="nesting-foot" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>This syntax is used to embody the concept of <em>nesting</em>, but that is beyond the scope of this lesson. All you really need to know is that <code class="docutils literal notranslate"><span class="pre">A/B</span> <span class="pre">=</span> <span class="pre">A</span> <span class="pre">+</span> <span class="pre">A:B</span></code>. So, specifying <code class="docutils literal notranslate"><span class="pre">S/A</span> <span class="pre">=</span> <span class="pre">A</span> <span class="pre">+</span> <span class="pre">S:A</span></code> and <code class="docutils literal notranslate"><span class="pre">S/(A*B)</span> <span class="pre">=</span> <span class="pre">S/(A</span> <span class="pre">+</span> <span class="pre">B</span> <span class="pre">+</span> <span class="pre">A:B)</span> <span class="pre">=</span> <span class="pre">S</span> <span class="pre">+</span> <span class="pre">S:A</span> <span class="pre">+</span> <span class="pre">S:B</span> <span class="pre">+</span> <span class="pre">S:A:B</span></code>.</p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="4.rm-anova-I.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">One-way Repeated Measures ANOVA</p>
      </div>
    </a>
    <a class="right-next"
       href="summary.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Summary</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-between-subjects-factors">Adding Between-subjects Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-between-subjects-error-term">The Between-subjects Error Term</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-between-subjects-error-in-r">Specifying Between-subjects Error in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-more-within-subject-factors">Adding More Within-subject Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-within-subject-error-terms">Multiple Within-subject Error Terms</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-bother-with-the-repeated-measures-anova">Why Bother with the Repeated Measures ANOVA?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>