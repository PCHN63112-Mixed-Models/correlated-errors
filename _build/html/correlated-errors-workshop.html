
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>PCHN63112 Workshop: Linear Models with Correlated Errors &#8212; Linear Models with Correlated Errors</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=a80109f0" />
    <link rel="stylesheet" type="text/css" href="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rgl.css?v=57907efa" />
    <link rel="stylesheet" type="text/css" href="_static/sphericity_3d_files/htmltools-fill-0.5.8.1/fill.css?v=971cc1da" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'correlated-errors-workshop';</script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/textures.src.js?v=9482728f"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/shadersrc.src.js?v=6ce05c17"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/buffer.src.js?v=1efca185"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/mouse.src.js?v=96f0b970"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/projection.src.js?v=98871b91"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/axes.src.js?v=3250d244"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rglTimer.src.js?v=ac1c3151"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/pretty.src.js?v=4f2cffba"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/shaders.src.js?v=bbbdf37d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/animation.src.js?v=74f9b9e8"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/pieces.src.js?v=280fd571"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/selection.src.js?v=5b47ed7d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/init.src.js?v=f5bdcbbb"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/subscenes.src.js?v=42cb429d"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/controls.src.js?v=4b3dbe6f"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/draw.src.js?v=49d9cbaa"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/utils.src.js?v=56efe719"></script>
    <script src="_static/sphericity_3d_files/rglwidgetClass-1.3.18/rglClass.src.js?v=9e593197"></script>
    <script src="_static/sphericity_3d_files/rglWebGL-binding-1.3.18/rglWebGL.js?v=8cd6f6d7"></script>
    <script src="_static/sphericity_3d_files/htmlwidgets-1.6.4/htmlwidgets.js?v=175713be"></script>
    <script src="_static/sphericity_3d_files/CanvasMatrix4-1.3.18/CanvasMatrix.src.js?v=5a2d04be"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Linear Models with Correlated Errors - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Linear Models with Correlated Errors - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.designs.html">Repeated Measurements</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.probability.html">Probability Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.paired-t.html">The Paired <em>t</em>-test</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.rm-anova.html">One-way Repeated Measures ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors/issues/new?title=Issue%20on%20page%20%2Fcorrelated-errors-workshop.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/correlated-errors-workshop.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PCHN63112 Workshop: Linear Models with Correlated Errors</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factorial-repeated-measures-anova-models">Factorial Repeated Measures ANOVA Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-between-subjects-factors">Adding Between-subjects Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-terms-for-tests">Error Terms for Tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-between-subjects-error-in-r">Specifying Between-subjects Error in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-errors-wrong">Getting the Errors Wrong</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-more-within-subject-factors">Adding More Within-subject Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-within-subject-error-terms">Multiple Within-subject Error Terms</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-bother-with-the-repeated-measures-anova">Why Bother with the Repeated Measures ANOVA?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pchn63112-workshop-linear-models-with-correlated-errors">
<h1>PCHN63112 Workshop: Linear Models with Correlated Errors<a class="headerlink" href="#pchn63112-workshop-linear-models-with-correlated-errors" title="Link to this heading">#</a></h1>
<p>In the associated lesson, we examined the theory behind traditional methods for analysing repeated measures data. In that lesson, we introduced the paired <span class="math notranslate nohighlight">\(t\)</span>-test and then discussed the one-way repeated measures ANOVA as a generalisation of the paired <span class="math notranslate nohighlight">\(t\)</span>-test. In this workshop, we will take things further and see how more complex repeated measures ANOVAs fit into this framework. As we will see, things start to become much more complicated, providing even further motivation for finding a better approach. The examples here are therefore <em>not</em> an endorsement of the repeated measures ANOVA. Rather, they serve as the clearest evidence of why you probably want to steer clear of this method.</p>
<section id="factorial-repeated-measures-anova-models">
<h2>Factorial Repeated Measures ANOVA Models<a class="headerlink" href="#factorial-repeated-measures-anova-models" title="Link to this heading">#</a></h2>
<p>In the associated lesson, we examined the simplest case of the repeated measures ANOVA. Despite the simplicity of the design, we saw how this analysis had several complications around the correct partition of the error, as well as the assumptions made about the covariance structure. These alone were enough to suggest that the repeated measures ANOVA framework was problematic to apply in practice. Yet, there are even more complex situations where this framework can be applied. In this workshop, we will see how the repeated measures ANOVA is used in situations where there are additional <em>between-subjects</em> factors, as well as multiple <em>within-subject</em> factors.</p>
</section>
<section id="adding-between-subjects-factors">
<h2>Adding Between-subjects Factors<a class="headerlink" href="#adding-between-subjects-factors" title="Link to this heading">#</a></h2>
<p>The first complexity we may come across is when we have a <em>between-subjects</em> factor alongside the repeated measurements. For example, the <code class="docutils literal notranslate"><span class="pre">datarium</span></code> package contains the dataset <code class="docutils literal notranslate"><span class="pre">anxiety</span></code>. Here, repeated measurements of anxiety have been taken at 3 different time points. The 45 subjects are split between 3 different exercise regimes and the experimental question concerns the relationship between exercise <code class="docutils literal notranslate"><span class="pre">group</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code> on anxiety <code class="docutils literal notranslate"><span class="pre">score</span></code>. So, <code class="docutils literal notranslate"><span class="pre">time</span></code> is the repeated measurement and <code class="docutils literal notranslate"><span class="pre">group</span></code> is the between-subjects factor. This is effectively a <span class="math notranslate nohighlight">\(3 \times 3\)</span> ANOVA, as illustrated in the table below.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Group: Low</p></th>
<th class="head"><p>Group: Moderate</p></th>
<th class="head"><p>Group: High</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Time: 1</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{11}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{12}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{13}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Time: 2</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{21}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{22}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{23}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><strong>Time: 3</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{31}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{32}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mu_{33}\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Our interest falls on the main effect of <code class="docutils literal notranslate"><span class="pre">group</span></code>, main effect of <code class="docutils literal notranslate"><span class="pre">time</span></code> and the <code class="docutils literal notranslate"><span class="pre">group:time</span></code> interaction. Based on what we covered in the lesson, we can apply the following two-way ANOVA model with partitioned errors</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    y_{ijk}    &amp;=    \mu + \alpha_{j} + \beta_{k} + (\alpha\beta)_{jk} + S_{i} + \eta_{ijk} \\
    S_{i}      &amp;\sim \mathcal{N}(0,\sigma^{2}_{b}) \\ 
    \eta_{ijk} &amp;\sim \mathcal{N}(0,\sigma^{2}_{w})
\end{alignat*}
\end{split}\]</div>
<p>Here we have added a term for the <em>between-subject</em> effect (denoted <span class="math notranslate nohighlight">\(\beta_{k}\)</span>), as well as the <em>between</em> <span class="math notranslate nohighlight">\(\times\)</span> <em>within</em> interaction (denoted <span class="math notranslate nohighlight">\((\alpha\beta)_{jk}\)</span>). So now <span class="math notranslate nohighlight">\(i\)</span> indexes the subject (<span class="math notranslate nohighlight">\(i = 1,\dots,45\)</span>), <span class="math notranslate nohighlight">\(j\)</span> indexes the repeated measurements (<span class="math notranslate nohighlight">\(j = 1,\dots,3\)</span>) and <span class="math notranslate nohighlight">\(k\)</span> indexes the exercise group (<span class="math notranslate nohighlight">\(k = 1,\dots,3\)</span>).</p>
<p>We can see this dataset below in its original form</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;datarium&#39;</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="s">&#39;anxiety&#39;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">anxiety</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  id group   t1   t2   t3
1  1  grp1 14.1 14.4 14.1
2  2  grp1 14.5 14.6 14.3
3  3  grp1 15.7 15.2 14.9
4  4  grp1 16.0 15.5 15.3
5  5  grp1 16.5 15.8 15.7
6  6  grp1 16.9 16.5 16.2
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY 1</b> Try to convert these data into <i>long</i>-format yourself, before looking at the code below. You can refer to the examples in the lesson to try and work this out.
</div><p>This can be reworked into long-format for univariate modelling using the code below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;reshape2&#39;</span><span class="p">)</span>

<span class="c1"># repeats and number of subjects</span>
<span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">3</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">45</span>

<span class="c1"># reshape wide -&gt; long</span>
<span class="n">anxiety.long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">melt</span><span class="p">(</span><span class="n">anxiety</span><span class="p">,</span><span class="w">                 </span><span class="c1"># wide data frame</span>
<span class="w">                     </span><span class="n">id.vars</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span><span class="s">&#39;group&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1"># both id and group stay fixed?</span>
<span class="w">                     </span><span class="n">variable.name</span><span class="o">=</span><span class="s">&#39;time&#39;</span><span class="p">,</span><span class="w">    </span><span class="c1"># name for the new predictor</span>
<span class="w">                     </span><span class="n">value.name</span><span class="o">=</span><span class="s">&#39;score&#39;</span><span class="p">)</span><span class="w">      </span><span class="c1"># name for the new outcome</span>

<span class="n">anxiety.long</span><span class="w">           </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">anxiety.long</span><span class="w"> </span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">anxiety.long</span><span class="o">$</span><span class="n">id</span><span class="p">),]</span><span class="w"> </span><span class="c1"># order by ID</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">anxiety.long</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="w">                             </span><span class="c1"># fix row names</span>
<span class="n">anxiety.long</span><span class="o">$</span><span class="n">id</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">anxiety.long</span><span class="o">$</span><span class="n">id</span><span class="p">)</span><span class="w">             </span><span class="c1"># id as factor</span>
<span class="n">anxiety.long</span><span class="o">$</span><span class="n">group</span><span class="w">     </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">anxiety.long</span><span class="o">$</span><span class="n">group</span><span class="p">)</span><span class="w">          </span><span class="c1"># group as factor</span>
<span class="n">anxiety.long</span><span class="o">$</span><span class="n">time</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">anxiety.long</span><span class="o">$</span><span class="n">time</span><span class="p">)</span><span class="w">           </span><span class="c1"># time as factor</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">anxiety.long</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  id group time score
1  1  grp1   t1  14.1
2  1  grp1   t2  14.4
3  1  grp1   t3  14.1
4  2  grp1   t1  14.5
5  2  grp1   t2  14.6
6  2  grp1   t3  14.3
</pre></div>
</div>
</div>
</div>
<p>So far, nothing has changed from what we have seen previously. However, we now have to think more carefully about the possible error terms and which is most sensible to use for each test.</p>
<section id="error-terms-for-tests">
<h3>Error Terms for Tests<a class="headerlink" href="#error-terms-for-tests" title="Link to this heading">#</a></h3>
<p>Recall from the lesson that a repeated measures ANOVA is effectively a linear model with <em>partitioned errors</em>. By splitting the errors into <span class="math notranslate nohighlight">\(\epsilon_{ijk} = S_{i} + \eta_{ijk}\)</span>, we are effectively specifying a model with <em>two</em> variance terms. So, the variance function of the model becomes</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(y_{ijk}) = \sigma^{2} = \sigma^{2}_{b} + \sigma^{2}_{w}.
\]</div>
<p>The point of doing this was two-fold:</p>
<ol class="arabic simple">
<li><p>It removes the correlation from the model errors and thus the model now meets the <span class="math notranslate nohighlight">\(i.i.d.\)</span> assumptions.</p></li>
<li><p>It removes error variance associated with the differences <em>between</em> the subjects, allowing any inferential tests to only use the variance associated with measurements <em>within</em> a subject.</p></li>
</ol>
<p>Practically, this means there are <em>two</em> possible error terms available for our hypothesis tests. So, we need to think about which source of variance is <em>most appropriate</em> for each test: <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span> or <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. In the one-way ANOVA example, the only effects were repeated measurement effects and the error term was derived from <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. This makes sense from the name alone, as the <em>within-subject</em> effects are tested using the <em>within-subject</em> variance.</p>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY 2</b> Given the logic above, which error do you think is most suitable for tests on <i>between-subjects</i> terms?
</div></section>
<section id="specifying-between-subjects-error-in-r">
<h3>Specifying Between-subjects Error in <code class="docutils literal notranslate"><span class="pre">R</span></code><a class="headerlink" href="#specifying-between-subjects-error-in-r" title="Link to this heading">#</a></h3>
<p>As is hopefully now clear, the introduction of a between-subjects effect into the model requires us to use the <em>within-subject</em> error term for some tests, as well as the <em>between-subjects</em> error term for other tests. As we established in the lesson, we can use <code class="docutils literal notranslate"><span class="pre">aov()</span></code> to express how we want the arithmetic of the ANOVA table to be organised. Again, this is a limitation of the repeated measures ANOVA because this requires some degree of manual intervention to state which terms we want treated as <em>error</em> and which we want treated as effects of interest. This can get complex very quickly and it is up to the analyst to indicate which terms are which.</p>
<p>For this example, the specification is fairly simple because we just denote the subject term as error and <code class="docutils literal notranslate"><span class="pre">aov()</span></code> will automatically arrange the tests for us. This is shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">anxiety.aov</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">Error</span><span class="p">(</span><span class="n">id</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">anxiety.long</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">anxiety.aov</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: id
          Df Sum Sq Mean Sq F value Pr(&gt;F)  
group      2  61.99  30.996   4.352 0.0192 *
Residuals 42 299.15   7.123                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: Within
           Df Sum Sq Mean Sq F value Pr(&gt;F)    
time        2  66.58   33.29   394.9 &lt;2e-16 ***
group:time  4  37.15    9.29   110.2 &lt;2e-16 ***
Residuals  84   7.08    0.08                   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>As we can see, the effect of <code class="docutils literal notranslate"><span class="pre">group</span></code> is now associated with <code class="docutils literal notranslate"><span class="pre">Error:</span> <span class="pre">id</span></code>, which represents the estimate of <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span>. The effect of <code class="docutils literal notranslate"><span class="pre">time</span></code> remains associated with <code class="docutils literal notranslate"><span class="pre">Error:</span> <span class="pre">Within</span></code>, which represents the estimate of <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. Notice as well that the interaction term <code class="docutils literal notranslate"><span class="pre">group:time</span></code> also uses <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>.</p>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY 3</b> Can you work out why the interaction term is associated with the <i>within-subject</i> error, rather than the <i>between-subjects</i> error? <b>HINT</b> This is quite tricky, but think about the <i>definition</i> of an interaction as well as what happens to the variance of the difference between two correlated random variables.
</div><p>We can also calculate the above using <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code>, without having to explicitly specify the error terms. We show this below, where we have just printed the ANOVA table for simplicity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;ez&#39;</span><span class="p">)</span>
<span class="n">anxiety.ez</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ezANOVA</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">anxiety.long</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="o">=</span><span class="n">score</span><span class="p">,</span><span class="w"> </span><span class="n">wid</span><span class="o">=</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">within</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">between</span><span class="o">=</span><span class="n">group</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">anxiety.ez</span><span class="o">$</span><span class="n">ANOVA</span><span class="p">)</span><span class="w"> </span><span class="c1"># just the ANOVA table w/o sphericity info</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Effect DFn DFd          F            p p&lt;.05       ges
2      group   2  42   4.351811 1.916093e-02     * 0.1683558
3       time   2  84 394.909490 1.905584e-43     * 0.1785886
4 group:time   4  84 110.187610 1.384653e-32     * 0.1081997
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY 4</b> Check the outputs from <code>aov()</code> and <code>ezANOVA()</code> to see the similarities and differences. What aspects is <code>ezANOVA()</code> <i>hiding</i> from you? If you were told to just use <code>ezANOVA()</code>, what aspects of the repeated measures ANOVA would not be immediately obvious?
</div></section>
<section id="getting-the-errors-wrong">
<h3>Getting the Errors Wrong<a class="headerlink" href="#getting-the-errors-wrong" title="Link to this heading">#</a></h3>
<p>Although both the above approaches are reasonably simple to specify, it is worth considering the implications of getting this <em>wrong</em>. To see this, let us specify this model using <code class="docutils literal notranslate"><span class="pre">lm()</span></code> and then look at the traditional ANOVA table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">anxiety.wrong.lm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">anxiety.long</span><span class="p">)</span>
<span class="nf">anova</span><span class="p">(</span><span class="n">anxiety.wrong.lm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Analysis of Variance Table

Response: score
           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
group       2  61.992  30.996 367.701 &lt; 2.2e-16 ***
time        2  66.579  33.289 394.909 &lt; 2.2e-16 ***
id         42 299.146   7.123  84.494 &lt; 2.2e-16 ***
group:time  4  37.154   9.288 110.188 &lt; 2.2e-16 ***
Residuals  84   7.081   0.084                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>Without any further information, both <code class="docutils literal notranslate"><span class="pre">lm()</span></code> and <code class="docutils literal notranslate"><span class="pre">anova()</span></code> treat every term in the formula as part of the <em>mean function</em> and thus assumes we are interested in each term for the purpose of inference. As we saw earlier, we can just ignore the tests on <code class="docutils literal notranslate"><span class="pre">id</span></code>. Its inclusion only serves to partitioned <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span> out from <span class="math notranslate nohighlight">\(\sigma^{2}\)</span>. However, this does mean that the <code class="docutils literal notranslate"><span class="pre">Residuals</span></code> term in the ANOVA table only represents <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>.</p>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY 5</b> Compare this table to the one from either <code>ezANOVA()</code> or <code>aov()</code>. Look specifically at the <i>F</i>-values and ignore the test on <code>id</code>. What are the biggest discrepancies you can see? Can you explain <i>why</i> before moving on?
</div><p>The use of <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> is fine for both the test on <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">group:time</span></code>, which are no different to the tests produced by <code class="docutils literal notranslate"><span class="pre">aov()</span></code> and <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code>. However, the crucial difference comes from the test of <code class="docutils literal notranslate"><span class="pre">group</span></code>. Notice that the <em>correct</em> test has <span class="math notranslate nohighlight">\(F = 4.35\)</span>, whereas the test above has <span class="math notranslate nohighlight">\(F = 367.70\)</span>. This is approximately 85 times <em>larger</em> than it should be! Such a huge discrepancy comes from the fact that the <em>incorrect</em> test is using <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> as the denominator, which is <em>much smaller</em> than <span class="math notranslate nohighlight">\(\sigma^{2}_{b}\)</span>. This makes the test <em>far too liberal</em>.</p>
<p>Although both versions of this test are still “significant”, it is not hard to imagine a situation where you could get a significant effect of <code class="docutils literal notranslate"><span class="pre">group</span></code> simply by specifying the wrong error. Getting this wrong could be disastrous because we might falsely claim that the between-subjects factor has an effect when it does not. Considering that these factors may correspond to something like patients vs controls, concluding a false difference could have serious implications. You might think this would be well understood, but only relatively recently was it brought up as an issue for fMRI data analysis as if it were some sudden new discovery (see poster 763 on page 67 of the following <a class="reference external" href="https://www.humanbrainmapping.org/files/2011MeetingFiles/HBM2011AbstractBook.pdf">Abstracts Booklet</a>). This actually shows how <em>little</em> the way the repeated measures ANOVA works is understood by most researchers.</p>
<p>We could also get this “wrong” by not partitioning the error at all and instead working with a <em>pooled</em> error of <span class="math notranslate nohighlight">\(\sigma^{2}_{b} + \sigma^{2}_{w}\)</span> for every test. An example of this is shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">anxiety.pooled.lm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">group</span><span class="o">*</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">anxiety.long</span><span class="p">)</span>
<span class="nf">anova</span><span class="p">(</span><span class="n">anxiety.pooled.lm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Analysis of Variance Table

Response: score
            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
group        2  61.992  30.996 12.7536 9.038e-06 ***
time         2  66.579  33.289 13.6973 4.143e-06 ***
group:time   4  37.154   9.288  3.8218  0.005753 ** 
Residuals  126 306.227   2.430                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>Notice that, by not acknowledging or accommodating the correlation or different variance sources, many of the tests have got <em>substantially</em> weaker. So we have <code class="docutils literal notranslate"><span class="pre">time</span></code>: <span class="math notranslate nohighlight">\(F = 394.9 \rightarrow 13.70\)</span> and <code class="docutils literal notranslate"><span class="pre">time:group</span></code>: <span class="math notranslate nohighlight">\(F = 110.2 \rightarrow 3.82\)</span>. So, by not doing this at all, we kill the power advantage of having a repeated measures experiment in the first place.</p>
</section>
</section>
<section id="adding-more-within-subject-factors">
<h2>Adding More Within-subject Factors<a class="headerlink" href="#adding-more-within-subject-factors" title="Link to this heading">#</a></h2>
<p>If all of the above was not bad enough, things get even trickier when we add <em>more</em> within-subject factors. We will not dwell on this too much because, as should be clear by now, we do not condone using the repeated measures ANOVA at all. However, this will provide the final clearest demonstration of <em>why</em> we want a much better framework for these type of data. The complexity demonstrated below is there to help you understand why you really do <em>not</em> want to do this. This is one of clearest cases where the automation provided by software such as SPSS (and, to an extent, <code class="docutils literal notranslate"><span class="pre">ezANOVA</span></code>) actively <em>hides</em> so much of the complexity that researchers do not think twice about designing studies that require these methods.</p>
<p>As our example, the <code class="docutils literal notranslate"><span class="pre">datarium</span></code> package contains a dataset called <code class="docutils literal notranslate"><span class="pre">weightloss</span></code> that represents a fully within-subject <span class="math notranslate nohighlight">\(2 \times 2 \times 3\)</span> design. There were 12 subjects whose weight was measured under combination of <code class="docutils literal notranslate"><span class="pre">diet</span></code> (<code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code>) and <code class="docutils literal notranslate"><span class="pre">exercises</span></code> (<code class="docutils literal notranslate"><span class="pre">yes</span></code> or <code class="docutils literal notranslate"><span class="pre">no</span></code>). For each combination of <code class="docutils literal notranslate"><span class="pre">diet</span></code> and <code class="docutils literal notranslate"><span class="pre">exercises</span></code>, the trial lasted 9 weeks, with measurements taken at 3 time-points. As such, every subject has 12 repeated measurements, representing every combination of <code class="docutils literal notranslate"><span class="pre">diet</span></code> and <code class="docutils literal notranslate"><span class="pre">exercises</span></code> across 3 values of <code class="docutils literal notranslate"><span class="pre">time</span></code>. The original dataset is shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;datarium&#39;</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="s">&#39;weightloss&#39;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">weightloss</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-C246"># A tibble: 6 × 6</span>
  id    diet  exercises    t1    t2    t3
  <span class=" -Color -Color-C246">&lt;fct&gt;</span> <span class=" -Color -Color-C246">&lt;fct&gt;</span> <span class=" -Color -Color-C246">&lt;fct&gt;</span>     <span class=" -Color -Color-C246">&lt;dbl&gt;</span> <span class=" -Color -Color-C246">&lt;dbl&gt;</span> <span class=" -Color -Color-C246">&lt;dbl&gt;</span>
<span class=" -Color -Color-C250">1</span> 1     no    no         10.4 13.2   11.6
<span class=" -Color -Color-C250">2</span> 2     no    no         11.6 10.7   13.2
<span class=" -Color -Color-C250">3</span> 3     no    no         11.4 11.1   11.4
<span class=" -Color -Color-C250">4</span> 4     no    no         11.1  9.5   11.1
<span class=" -Color -Color-C250">5</span> 5     no    no          9.5  9.73  12.3
<span class=" -Color -Color-C250">6</span> 6     no    no          9.5 12.7   10.4
</pre></div>
</div>
</div>
</div>
<p>which we again convert to long format. These data are arranged slight strangely because they are long-format, but per-time point. So <code class="docutils literal notranslate"><span class="pre">time</span></code> is wide-formatted, but both <code class="docutils literal notranslate"><span class="pre">diet</span></code> and <code class="docutils literal notranslate"><span class="pre">exercise</span></code> are long-formatted. This half-way house is not actually very useful for <em>any</em> type of modelling. The code below will get these data in a clearer long-format across all the variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;reshape2&#39;</span><span class="p">)</span>

<span class="c1"># repeats and number of subjects</span>
<span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="c1"># 2 * 2 * 3</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">12</span>

<span class="c1"># reshape wide -&gt; long</span>
<span class="n">weightloss.long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">melt</span><span class="p">(</span><span class="n">weightloss</span><span class="p">,</span><span class="w">                         </span><span class="c1"># wide data frame</span>
<span class="w">                        </span><span class="n">id.vars</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span><span class="s">&#39;diet&#39;</span><span class="p">,</span><span class="s">&#39;exercises&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1"># what stays fixed?</span>
<span class="w">                        </span><span class="n">variable.name</span><span class="o">=</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="w">               </span><span class="c1"># name for the new predictor</span>
<span class="w">                        </span><span class="n">value.name</span><span class="o">=</span><span class="s">&quot;weight&quot;</span><span class="p">)</span><span class="w">                </span><span class="c1"># name for the new outcome</span>

<span class="n">weightloss.long</span><span class="w">           </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">weightloss.long</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">weightloss.long</span><span class="o">$</span><span class="n">id</span><span class="p">),]</span><span class="w"> </span><span class="c1"># order by ID</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">weightloss.long</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="w">                                  </span><span class="c1"># fix row names</span>

<span class="n">weightloss.long</span><span class="o">$</span><span class="n">id</span><span class="w">        </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">weightloss.long</span><span class="o">$</span><span class="n">id</span><span class="p">)</span><span class="w">               </span><span class="c1"># id as factor</span>
<span class="n">weightloss.long</span><span class="o">$</span><span class="n">diet</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">weightloss.long</span><span class="o">$</span><span class="n">diet</span><span class="p">)</span><span class="w">             </span><span class="c1"># diet as factor</span>
<span class="n">weightloss.long</span><span class="o">$</span><span class="n">exercises</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">weightloss.long</span><span class="o">$</span><span class="n">exercises</span><span class="p">)</span><span class="w">        </span><span class="c1"># exercises as factor</span>
<span class="n">weightloss.long</span><span class="o">$</span><span class="n">time</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">weightloss.long</span><span class="o">$</span><span class="n">time</span><span class="p">)</span><span class="w">             </span><span class="c1"># time as factor</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="n">weightloss.long</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  id diet exercises time weight
1  1   no        no   t1  10.43
2  1   no       yes   t1  11.12
3  1  yes        no   t1  10.20
4  1  yes       yes   t1  10.43
5  1   no        no   t2  13.21
6  1   no       yes   t2  12.51
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY 6</b> Can you think about how these data would be arranged if they were <i>purely</i> wide-formatted? If they were, could you convert them cleanly to long-format, or would you require the specification of <i>new</i> variables?
</div><section id="multiple-within-subject-error-terms">
<h3>Multiple Within-subject Error Terms<a class="headerlink" href="#multiple-within-subject-error-terms" title="Link to this heading">#</a></h3>
<p>In order to understand what we have to do when there are <em>multiple</em> within-subject factors, let us start by specifying the same partitioned error model we used above with <code class="docutils literal notranslate"><span class="pre">aov()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">weightloss.aov</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">diet</span><span class="o">*</span><span class="n">exercises</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">Error</span><span class="p">(</span><span class="n">id</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">weightloss.long</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">weightloss.aov</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: id
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 11   27.1   2.463               

Error: Within
                     Df Sum Sq Mean Sq F value   Pr(&gt;F)    
diet                  1   5.11    5.11   4.069   0.0459 *  
exercises             1  71.16   71.16  56.647 1.03e-11 ***
time                  2 211.39  105.69  84.134  &lt; 2e-16 ***
diet:exercises        1  33.40   33.40  26.586 9.96e-07 ***
diet:time             2   2.42    1.21   0.963   0.3846    
exercises:time        2  67.43   33.72  26.839 2.25e-10 ***
diet:exercises:time   2  30.77   15.39  12.249 1.43e-05 ***
Residuals           121 152.01    1.26                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>In this scenario, <code class="docutils literal notranslate"><span class="pre">diet</span></code>, <code class="docutils literal notranslate"><span class="pre">exercises</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code> are all using the <em>same</em> within-subject error term. But is this appropriate?</p>
<p>If we focus on the test of <code class="docutils literal notranslate"><span class="pre">diet</span></code>, the error term is <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>. This <em>will</em> contain the variation associated with the different diet conditions within each subject, which is what we want. However, it will <em>also</em> contain variation associated with the different levels of <code class="docutils literal notranslate"><span class="pre">exercises</span></code> and the different levels of <code class="docutils literal notranslate"><span class="pre">time</span></code>. If our focus is <code class="docutils literal notranslate"><span class="pre">diet</span></code> alone, it seems inappropriate to include the uncertainty around <code class="docutils literal notranslate"><span class="pre">exercises</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>.</p>
<p>Similarly, if we are interested in the <code class="docutils literal notranslate"><span class="pre">diet:time</span></code> interaction, using <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> means including variation associated with both <code class="docutils literal notranslate"><span class="pre">diet</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>, as we want, but will <em>also</em> include variation associated with <code class="docutils literal notranslate"><span class="pre">exercises</span></code>. This additional variation is of no relevance if we are only interested in the <code class="docutils literal notranslate"><span class="pre">diet:time</span></code> effect.</p>
<p>What this means is that whenever there are <em>multiple</em> within-subject factors, we can <em>further partition</em> <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> into <em>more error terms</em> that are <em>more suitable</em> for each of these effects. The way this is achieved is by specifying <em>interactions</em> between the subject effects and the factors associated with each effect. Doing so will create subject-specific errors for just the terms of interest, averaging-over all other terms. So, for instance, <code class="docutils literal notranslate"><span class="pre">id:diet</span></code> produces subject-specific effects for <code class="docutils literal notranslate"><span class="pre">diet</span></code>, averaging-over both <code class="docutils literal notranslate"><span class="pre">time</span></code> and <code class="docutils literal notranslate"><span class="pre">exercises</span></code>. This produces a more suitable error term for testing the effect of <code class="docutils literal notranslate"><span class="pre">diet</span></code> compared to just using <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span>.</p>
<p>If we continue this logic for all other terms, we get an error structure where we can partition <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> into further terms by taking all possible interactions between <code class="docutils literal notranslate"><span class="pre">subject</span></code> and the within-subject factors. Using <code class="docutils literal notranslate"><span class="pre">aov()</span></code>, this becomes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">weightloss.aov</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">diet</span><span class="o">*</span><span class="n">exercises</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                               </span><span class="nf">Error</span><span class="p">(</span><span class="n">id</span><span class="w">                </span><span class="o">+</span><span class="w"> </span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">diet</span><span class="w">           </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">exercises</span><span class="w">      </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">time</span><span class="w">           </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">exercises</span><span class="o">:</span><span class="n">time</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">exercises</span><span class="o">:</span><span class="n">diet</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">time</span><span class="o">:</span><span class="n">diet</span><span class="w">      </span><span class="o">+</span>
<span class="w">                                     </span><span class="n">id</span><span class="o">:</span><span class="n">time</span><span class="o">:</span><span class="n">exercises</span><span class="o">:</span><span class="n">diet</span><span class="p">),</span><span class="w"> </span>
<span class="w">                        </span><span class="n">data</span><span class="o">=</span><span class="n">weightloss.long</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">weightloss.aov</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: id
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals 11   27.1   2.463               

Error: id:diet
          Df Sum Sq Mean Sq F value Pr(&gt;F)  
diet       1  5.111   5.111   6.021  0.032 *
Residuals 11  9.337   0.849                 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:exercises
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
exercises  1  71.16   71.16   58.93 9.65e-06 ***
Residuals 11  13.28    1.21                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:time
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
time       2 211.39  105.69   110.9 3.22e-12 ***
Residuals 22  20.96    0.95                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:exercises:time
               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
exercises:time  2  67.43   33.72   20.83 8.41e-06 ***
Residuals      22  35.62    1.62                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:diet:exercises
               Df Sum Sq Mean Sq F value   Pr(&gt;F)    
diet:exercises  1  33.40   33.40   75.36 2.98e-06 ***
Residuals      11   4.88    0.44                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Error: id:diet:time
          Df Sum Sq Mean Sq F value Pr(&gt;F)
diet:time  2   2.42   1.210   0.603  0.556
Residuals 22  44.17   2.008               

Error: id:diet:exercises:time
                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
diet:exercises:time  2  30.77   15.39   14.25 0.000107 ***
Residuals           22  23.76    1.08                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"> 
<b>ACTIVITY 7</b> Take a moment to examine the output above. It looks very complicated, because it <i>is</i> very complicated. This is the logical conclusion of a method where error partitioning is performed within a model that only really has <i>one</i> error term and then requires <i>manual assignment</i> of error terms for different tests. 
<br><br>
If this output is surprising, it might be worth convincing yourself that this is <i>exactly</i> how a repeated measures ANOVA works in other software. For instance, consider the output table from SPSS in the image before. Notice that this is a single ANOVA table, but split into multiple <i>sub-tables</i>, depending upon the error terms. Now you know why.
<br><br>
<img src="images/SPSS-ANOVA.png">
</div><p>We are making no excuses for this approach. It is hideous to specify, difficult to understand, hard to interpret and very easy to get wrong. You may see examples where a short-hand is used to construct the error terms, as shown below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">aov.alt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">diet</span><span class="o">*</span><span class="n">exercises</span><span class="o">*</span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">Error</span><span class="p">(</span><span class="n">id</span><span class="o">/</span><span class="p">(</span><span class="n">diet</span><span class="o">*</span><span class="n">exercises</span><span class="o">*</span><span class="n">time</span><span class="p">)),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">weightloss.long</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The syntax <code class="docutils literal notranslate"><span class="pre">id/(diet*exercises*time)</span></code> can be read as a request to include the main effect of the term on the <em>left</em> of <code class="docutils literal notranslate"><span class="pre">/</span></code> alongside all possible interactions with the terms on the <em>right</em> of <code class="docutils literal notranslate"><span class="pre">/</span></code>. You will often see <code class="docutils literal notranslate"><span class="pre">Error()</span></code> code written like this, but it is not very informative unless you understand what this evaluates to, as shown <em>explicitly</em> in the earlier example.</p>
<p>In general, it is <em>not recommended</em> to use <code class="docutils literal notranslate"><span class="pre">aov()</span></code> like this. Not only is it <em>difficult</em> and prone to <em>mistakes</em>, but the output is <em>unwieldly</em>. A better approach, if you <em>must</em> use a repeated measures ANOVA, is the <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code> function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;ez&#39;</span><span class="p">)</span>
<span class="n">weightloss.ez</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ezANOVA</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">weightloss.long</span><span class="p">,</span><span class="w"> </span><span class="n">dv</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span><span class="w"> </span><span class="n">wid</span><span class="o">=</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">within</span><span class="o">=</span><span class="nf">.</span><span class="p">(</span><span class="n">diet</span><span class="p">,</span><span class="n">exercises</span><span class="p">,</span><span class="n">time</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">weightloss.ez</span><span class="o">$</span><span class="n">ANOVA</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Effect DFn DFd          F            p p&lt;.05        ges
2                diet   1  11   6.021440 3.202562e-02     * 0.02774675
3           exercises   1  11  58.928078 9.650954e-06     * 0.28434954
4                time   2  22 110.941583 3.218470e-12     * 0.54133853
5      diet:exercises   1  11  75.356051 2.980284e-06     * 0.15716889
6           diet:time   2  22   0.602562 5.561945e-01       0.01332945
7      exercises:time   2  22  20.825889 8.408790e-06     * 0.27352201
8 diet:exercises:time   2  22  14.246076 1.074451e-04     * 0.14663048
</pre></div>
</div>
</div>
</div>
<p>The output will match the result of <code class="docutils literal notranslate"><span class="pre">aov()</span></code>, but in a much nicer format, with the additional advantage of the sphericity corrections.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="n">weightloss.ez</span><span class="o">$</span><span class="n">`Sphericity Corrections`</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>               Effect       GGe        p[GG] p[GG]&lt;.05       HFe        p[HF]
4                time 0.9836155 4.732515e-12         * 1.1960214 3.218470e-12
6           diet:time 0.6893303 5.008306e-01           0.7558161 5.144265e-01
7      exercises:time 0.7596029 7.470601e-05         * 0.8559657 3.105108e-05
8 diet:exercises:time 0.9605626 1.395812e-04         * 1.1594775 1.074451e-04
  p[HF]&lt;.05
4         *
6          
7         *
8         *
</pre></div>
</div>
</div>
</div>
<p>However, this approach does hide the fundamental difficulty with assigning tests to different error terms and thus hides much of the complexity and the disadvantages of the repeated measures ANOVA framework. We also have the problem that, by going down this route, we have effectively thrown away the linear model framework we have been working so hard to build. We end up with an ANOVA table and nothing else. Is this is all you want, then so be it. However, the better approaches to this situation, as we will learn in the coming weeks.</p>
</section>
</section>
<section id="why-bother-with-the-repeated-measures-anova">
<h2>Why Bother with the Repeated Measures ANOVA?<a class="headerlink" href="#why-bother-with-the-repeated-measures-anova" title="Link to this heading">#</a></h2>
<p>Everything we have discussed in this workshop has been an exercise in telling you why you really <em>do not want to use a repeated measures ANOVA</em>. All the unnecessary fiddling with different error terms and different tests is a complication that we could simply do without. In the past, this was the <em>only</em> way to deal with repeated measures, but that is no longer the case. Ultimately, the concept of multiple error terms and multiple sources of error variance are perfectly sound. Indeed, we will see that this is the basis of mixed-effects models. However, getting this to work within the linear models framework, and within the traditional ANOVA framework, is fraught with difficulties. The repeated measures ANOVA is one solution to this, but is really an <em>ad hoc</em> workaround for an analysis that is ill-suited for this framework. We can use software to hide much of this complexity, but that does not mean it goes away.</p>
<p>Even if we are comfortable generating the correct output using <code class="docutils literal notranslate"><span class="pre">R</span></code>, particularly with access to something like <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code>, we are still left with a method that has a number of meaningful restrictions. Perhaps most concerning is the assumption of <em>compound symmetry</em>, because this will always be dubious in real-world data. Yes we can use some sort of correction for this, but this correction only applies to the inferential tests (not the model) and remains a further <em>ad hoc</em> adjustment to make the framework <em>approximately</em> correct.</p>
<p>Taking all this together, we can conclude that the repeated measures ANOVA is tricky to understand, tricky to use correctly and largely inflexible. It is perhaps no wonder that statisticians abandoned this method decades ago. Unfortunately, you are likely to come across people still using the repeated measures ANOVA to this day. You may even work for some of them who will <em>insist</em> that you use a repeated measures ANOVA to analyse their data. In those situations, it is useful to (a) motivate the need for something better and (b) understand how to get the ANOVA results in <code class="docutils literal notranslate"><span class="pre">R</span></code>. So, we do not condone the use of the repeated measures ANOVA, but we understand its place in psychology and also understand that there are times where you may need to see what the repeated measures ANOVA says, even if you do not wish to use it. Over the next few weeks, we will show you how to replace this framework with something much better in the form of <em>mixed-effects models</em>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factorial-repeated-measures-anova-models">Factorial Repeated Measures ANOVA Models</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-between-subjects-factors">Adding Between-subjects Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-terms-for-tests">Error Terms for Tests</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#specifying-between-subjects-error-in-r">Specifying Between-subjects Error in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-the-errors-wrong">Getting the Errors Wrong</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-more-within-subject-factors">Adding More Within-subject Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-within-subject-error-terms">Multiple Within-subject Error Terms</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-bother-with-the-repeated-measures-anova">Why Bother with the Repeated Measures ANOVA?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>