
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>The Repeated Measures ANOVA &#8212; Linear Models with Correlated Errors</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/test.css?v=90b7ad94" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4.rm-anova';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Generalised Least Squares" href="5.gls.html" />
    <link rel="prev" title="The Paired t-test" href="3.paired-t.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Linear Models with Correlated Errors - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Linear Models with Correlated Errors - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.designs.html">Repeated Measurement Designs</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.probability.html">Probability Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.paired-t.html">The Paired <em>t</em>-test</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">The Repeated Measures ANOVA</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.gls.html">Generalised Least Squares</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/correlated-errors/issues/new?title=Issue%20on%20page%20%2F4.rm-anova.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/4.rm-anova.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Repeated Measures ANOVA</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations-of-the-model-of-paired-differences">Limitations of the Model of <em>Paired Differences</em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model-of-partitioned-errors">The Model of <em>Partitioned Errors</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partitioned-errors-in-r">Partitioned Errors in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-implied-covariance-structure">The Implied Covariance Structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-sphericity-condition">The Sphericity Condition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#between-subjects-factors">Between-subjects Factors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-within-subject-factors">Additional Within-subject Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-ezanova-function">Using the <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code> Function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-we-should-not-use-rm-anova">Why We Should <em>Not</em> Use RM ANOVA</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="the-repeated-measures-anova">
<h1>The Repeated Measures ANOVA<a class="headerlink" href="#the-repeated-measures-anova" title="Link to this heading">#</a></h1>
<p>In the previous part of this lesson, we examined the paired <span class="math notranslate nohighlight">\(t\)</span>-test as the most basic method for dealing with repeated measurements. In doing do, we established that taking the <em>difference</em> between the pairs was enough to remove correlation and render the data independent, allowing us to specify a simple one-sample test on the mean difference. In order to understand this, we split our usual single error term into two components, one associated with each subject and one associated with any other deviations. We then saw how the term associated with each subject <em>cancelled</em> when the pairs were subtracted, implying that this component captured the correlation between the repeated measurements. Furthermore, by viewing these terms in relation to a partition of the error variance, we established that it is the <em>between-subjects</em> variance that is removed by subtraction, leaving only the <em>within-subject</em> variance. Because this is smaller than the total variance, and smaller than the between-subjects variance, this rendered the standard error of the estimated mean difference smaller, thus making the test statistic larger. This not only established <em>why</em> the paired <span class="math notranslate nohighlight">\(t\)</span>-test is different to the independent measures <span class="math notranslate nohighlight">\(t\)</span>-test, but also why the paired <span class="math notranslate nohighlight">\(t\)</span>-test is typically <em>more powerful</em> and thus desirable, from an inferential perspective.</p>
<section id="limitations-of-the-model-of-paired-differences">
<h2>Limitations of the Model of <em>Paired Differences</em><a class="headerlink" href="#limitations-of-the-model-of-paired-differences" title="Link to this heading">#</a></h2>
<p>Although this <em>paired differences</em> framework works well when the data consists of only <em>two</em> repeated measurements, we hit a problem if we have <em>more than two</em> repeated measurements, <em>more than one</em> repeated measures factor or even when we have a mixture of repeated measurements and independent measurements. In many of these cases, we cannot take a simple subtraction and then analyse the resultant differences. So, while the paired <span class="math notranslate nohighlight">\(t\)</span>-test is fine in simple cases, it does not generalise very easily.</p>
<p>In order to allow the analysis of more complex experimental situations, we need to abandon the idea of making the data independent through subtraction. Instead, we need to accommodate the correlation <em>directly</em> within the model. The general theme of this section of the unit is <em>mixed-effects models</em>, which represent the most modern solution to this problem. However, in this part of the lesson we will discuss an older solution in the form of the <em>repeated measures ANOVA</em>. This is really a stepping-stone towards mixed-effects models, rather than a recommendation, as the repeated measures ANOVA is rather limited in practice. Nevertheless, this method is still used widely in psychological research and so is still worth understanding.</p>
</section>
<section id="the-model-of-partitioned-errors">
<h2>The Model of <em>Partitioned Errors</em><a class="headerlink" href="#the-model-of-partitioned-errors" title="Link to this heading">#</a></h2>
<p>As mentioned above, because <em>subtraction</em> only works in a number of limited cases, we need to abandon it as our general solution to dealing with dependent data. Instead, we need to work with data that we <em>know</em> is correlated. Unfortunately, as we have already established, the linear model framework assumes that the errors of the model are <span class="math notranslate nohighlight">\(i.i.d.\)</span>, which will not be true under repeated measurements. However, we have already seen a possible solution to this problem, as the removal of the subject terms <span class="math notranslate nohighlight">\(S_{i}\)</span> theoretically <em>removes</em> the correlation and renders the errors independent. Thus, if we were to <em>include</em> the term <span class="math notranslate nohighlight">\(S_{i}\)</span> in the model, the errors would meet the <span class="math notranslate nohighlight">\(i.i.d.\)</span> criteria. Furthermore, the single error variance assumed by the linear model would be the <em>within-subject</em> variance and thus would be suitable for inference on the repeated measurements. Putting all this together gives us the model</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    y_{ij}    &amp;=                      \mu + \alpha_{j} + S_{i} + \eta_{ij} \\
    \eta_{ij} &amp;\overset{i.i.d.}{\sim} \mathcal{N}(0,\sigma^{2}_{w})
\end{alignat*}
\end{split}\]</div>
<p>which is the basis for the repeated measures ANOVA.</p>
<p>Now, in the specification above, we have treated <span class="math notranslate nohighlight">\(S_{i}\)</span> like any other factor in an ANOVA model. However, this is not really correct. As discussed in the previous part of this lesson, <span class="math notranslate nohighlight">\(S_{i}\)</span> comes from <em>splitting</em> the overall error term <span class="math notranslate nohighlight">\(\epsilon_{ij}\)</span>. So, in theory, rather than representing population constants (like <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\alpha_{j}\)</span>), the <span class="math notranslate nohighlight">\(S_{i}\)</span> are a <em>random variable</em>. This makes sense because the subjects represent a <em>random sample</em>, rather than a fixed quantity. If we were to run the experiment again, <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\alpha_{j}\)</span> would be the <em>same</em>, but the <span class="math notranslate nohighlight">\(S_{i}\)</span> would be <em>different</em>. Rather than <span class="math notranslate nohighlight">\(S_{i}\)</span> representing the <span class="math notranslate nohighlight">\(i\)</span>th level of an <span class="math notranslate nohighlight">\(n\)</span>-dimensional experimental factor, it is the <span class="math notranslate nohighlight">\(i\)</span>th <em>random deviation</em>. From this perspective, <span class="math notranslate nohighlight">\(S_{i}\)</span> is clearly an <em>additional error term</em>. Unfortunately, the linear model only has <em>one</em> error term. Thus, what we <em>want</em> to use is the model</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    y_{ij}    &amp;=    \mu + \alpha_{j} + S_{i} + \eta_{ij} \\
    S_{i}     &amp;\sim \mathcal{N}(0,\sigma^{2}_{b})        \\
    \eta_{ij} &amp;\sim \mathcal{N}(0,\sigma^{2}_{w})
\end{alignat*}
\end{split}\]</div>
<p>but we cannot, because this would require a method that could flexibly accommodate multiple error terms (which is exactly what <em>mixed-effects</em> model do). Instead, the repeated measures ANOVA aims to <em>replicate</em> this situation within the confines of a modelling framework that <em>does not allow it</em>. As you might imagine, this involves jumping through a number of hoops and places a number of restrictions on what is possible.</p>
<section id="partitioned-errors-in-r">
<h3>Partitioned Errors in <code class="docutils literal notranslate"><span class="pre">R</span></code><a class="headerlink" href="#partitioned-errors-in-r" title="Link to this heading">#</a></h3>
<p>Before discussing this in more detail, we will demonstrate the general idea in <code class="docutils literal notranslate"><span class="pre">R</span></code> in two ways, one using <code class="docutils literal notranslate"><span class="pre">lm()</span></code> and one using the <code class="docutils literal notranslate"><span class="pre">aov()</span></code> function. We have not covered <code class="docutils literal notranslate"><span class="pre">aov()</span></code> previously, but this is a wrapper for <code class="docutils literal notranslate"><span class="pre">lm()</span></code> that can accommodate partitioned errors.</p>
<p>To begin with, let us specify the model above that contains the subject terms. We will do this using the <code class="docutils literal notranslate"><span class="pre">mice2</span></code> data again, so we can show agreement with the paired <span class="math notranslate nohighlight">\(t\)</span>-test. However, we need to first convert this data into <em>long</em> format.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;datarium&#39;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&#39;reshape2&#39;</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="s">&#39;mice2&#39;</span><span class="p">)</span>

<span class="c1"># repeats and number of subjects</span>
<span class="n">t</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">2</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">dim</span><span class="p">(</span><span class="n">mice2</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span>

<span class="c1"># reshape wide -&gt; long</span>
<span class="n">mice2.long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">melt</span><span class="p">(</span><span class="n">mice2</span><span class="p">,</span><span class="w">                       </span><span class="c1"># wide data frame</span>
<span class="w">                   </span><span class="n">id.vars</span><span class="o">=</span><span class="s">&#39;id&#39;</span><span class="p">,</span><span class="w">                </span><span class="c1"># what stays fixed?</span>
<span class="w">                   </span><span class="n">variable.name</span><span class="o">=</span><span class="s">&quot;time&quot;</span><span class="p">,</span><span class="w">        </span><span class="c1"># name for the new predictor</span>
<span class="w">                   </span><span class="n">value.name</span><span class="o">=</span><span class="s">&quot;weight&quot;</span><span class="p">)</span><span class="w">         </span><span class="c1"># name for the new outcome</span>

<span class="n">mice2.long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mice2.long</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">mice2.long</span><span class="o">$</span><span class="n">id</span><span class="p">),]</span><span class="w"> </span><span class="c1"># order by ID</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">mice2.long</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">n</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="w">              </span><span class="c1"># fix row names</span>

<span class="c1"># make id a factor</span>
<span class="n">mice2.long</span><span class="o">$</span><span class="n">id</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">mice2.long</span><span class="o">$</span><span class="n">id</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">mice2.long</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   id   time weight
1   1 before  187.2
2   1  after  429.5
3   2 before  194.2
4   2  after  404.4
5   3 before  231.7
6   3  after  405.6
7   4 before  200.5
8   4  after  397.2
9   5 before  201.7
10  5  after  377.9
11  6 before  235.0
12  6  after  445.8
13  7 before  208.7
14  7  after  408.4
15  8 before  172.4
16  8  after  337.0
17  9 before  184.6
18  9  after  414.3
19 10 before  189.6
20 10  after  380.3
</pre></div>
</div>
</div>
</div>
<p>Now, we can specify the partitioned error model using <code class="docutils literal notranslate"><span class="pre">lm()</span></code> below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">rm.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mice2.long</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">rm.mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = weight ~ time + id, data = mice2.long)

Residuals:
    Min      1Q  Median      3Q     Max 
-21.410  -7.155   0.000   7.155  21.410 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  208.610     12.949  16.110 6.06e-08 ***
timeafter    199.480      7.809  25.546 1.04e-09 ***
id2           -9.050     17.460  -0.518   0.6167    
id3           10.300     17.460   0.590   0.5698    
id4           -9.500     17.460  -0.544   0.5996    
id5          -18.550     17.460  -1.062   0.3157    
id6           32.050     17.460   1.836   0.0996 .  
id7            0.200     17.460   0.011   0.9911    
id8          -53.650     17.460  -3.073   0.0133 *  
id9           -8.900     17.460  -0.510   0.6225    
id10         -23.400     17.460  -1.340   0.2130    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 17.46 on 9 degrees of freedom
Multiple R-squared:  0.987,	Adjusted R-squared:  0.9725 
F-statistic: 68.22 on 10 and 9 DF,  p-value: 2.985e-07
</pre></div>
</div>
</div>
</div>
<p>Ignoring the subject effects, if we look at the test on <code class="docutils literal notranslate"><span class="pre">timeafter</span></code>, we can see that this agrees with the paired <span class="math notranslate nohighlight">\(t\)</span>-test from earlier, as repeated below</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">t.test</span><span class="p">(</span><span class="n">mice2</span><span class="o">$</span><span class="n">before</span><span class="p">,</span><span class="w"> </span><span class="n">mice2</span><span class="o">$</span><span class="n">after</span><span class="p">,</span><span class="w"> </span><span class="n">paired</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Paired t-test

data:  mice2$before and mice2$after
t = -25.546, df = 9, p-value = 1.039e-09
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -217.1442 -181.8158
sample estimates:
mean difference 
        -199.48 
</pre></div>
</div>
</div>
</div>
<p>We can tidy this output up a bit by calling <code class="docutils literal notranslate"><span class="pre">Anova()</span></code> on the model</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;car&#39;</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">Anova</span><span class="p">(</span><span class="n">rm.mod</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Anova Table (Type II tests)

Response: weight
          Sum Sq Df F value    Pr(&gt;F)    
time      198961  1 652.613 1.039e-09 ***
id          9013  9   3.285   0.04559 *  
Residuals   2744  9                      
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>Where, again, we would ignore the test on <code class="docutils literal notranslate"><span class="pre">id</span></code> and just focus on the effect of <code class="docutils literal notranslate"><span class="pre">time</span></code>. However, the fact that a test on <code class="docutils literal notranslate"><span class="pre">id</span></code> has been produced suggests that this model term is not really being treated correctly. After all, do we want a hypothesis test based on the null that all the subject means are the same? Given that this is a random sample of subjects, how meaningful would this be unless these were the only subjects in the world that we were interested in? As indicated above, the <code class="docutils literal notranslate"><span class="pre">id</span></code> effect is not really an effect of interest in the same way as <code class="docutils literal notranslate"><span class="pre">time</span></code>. In fact, <code class="docutils literal notranslate"><span class="pre">id</span></code> is considered <em>error</em>. It would be like specifying a hypothesis test on the model residuals. We are not interested in estimating some universal truth here because what we have are <em>random deviations</em> reflective of <em>error variance</em>. As such, in much the same way that the residuals are used to estimate the <em>within-subject</em> variance, we want the values of <code class="docutils literal notranslate"><span class="pre">id</span></code> to be used to estimate the <em>between-subjects</em> variance.</p>
<p>In order to tell <code class="docutils literal notranslate"><span class="pre">R</span></code> that <code class="docutils literal notranslate"><span class="pre">id</span></code> is an <em>additional error term</em>, we can use the <code class="docutils literal notranslate"><span class="pre">aov()</span></code> function. This is a wrapper for <code class="docutils literal notranslate"><span class="pre">lm()</span></code> designed to produce an ANOVA table where some of the model terms represent <em>error</em> rather than a traditional ANOVA effect. From an <em>estimation</em> perspective, this distinction does not make any difference because ANOVA <em>mean squares</em> are already estimates of variance. However, what <em>does</em> matter, is whether these mean squares form the <em>numerator</em> of an <span class="math notranslate nohighlight">\(F\)</span>-ratio (variance associated with <em>mean differences</em>) or the <em>denominator</em> of an <span class="math notranslate nohighlight">\(F\)</span>-ratio (variance associated with <em>error</em>). So, what we are really doing is telling <code class="docutils literal notranslate"><span class="pre">R</span></code> where to place the different mean squares in the ANOVA table.</p>
<p>An example of using <code class="docutils literal notranslate"><span class="pre">aov()</span></code> for the <code class="docutils literal notranslate"><span class="pre">mice2</span></code> data is shown below. Here we use the <code class="docutils literal notranslate"><span class="pre">Error()</span></code> syntax within the model formula to indicate that <code class="docutils literal notranslate"><span class="pre">id</span></code> is an <em>error term</em>. This results in <em>two</em> ANOVA tables. One where <span class="math notranslate nohighlight">\(S_{i}\)</span> forms the error term and one where <span class="math notranslate nohighlight">\(\eta_{ij}\)</span> forms the error term. Based on the model structure, <code class="docutils literal notranslate"><span class="pre">aov()</span></code> can work out that <code class="docutils literal notranslate"><span class="pre">time</span></code> should have <span class="math notranslate nohighlight">\(\sigma^{2}_{w}\)</span> as its denominator in the <span class="math notranslate nohighlight">\(F\)</span>-ratio and thus has associated it with the correct ANOVA table. As there are no other terms in the model, the ANOVA table with <span class="math notranslate nohighlight">\(id\)</span> as the error is empty.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">rm.aov.mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">Error</span><span class="p">(</span><span class="n">id</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">mice2.long</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">summary</span><span class="p">(</span><span class="n">rm.aov.mod</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error: id
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Residuals  9   9013    1002               

Error: Within
          Df Sum Sq Mean Sq F value   Pr(&gt;F)    
time       1 198961  198961   652.6 1.04e-09 ***
Residuals  9   2744     305                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
</pre></div>
</div>
</div>
</div>
<p>Notice that the test results have remained the same throughout all these examples. So, for this simple situation, we could use <code class="docutils literal notranslate"><span class="pre">t.test(...,</span> <span class="pre">paired=TRUE)</span></code>, <code class="docutils literal notranslate"><span class="pre">lm()</span></code>, <code class="docutils literal notranslate"><span class="pre">Anova(lm())</span></code>, or <code class="docutils literal notranslate"><span class="pre">aov(...</span> <span class="pre">+</span> <span class="pre">Error(id))</span></code>. However, as we add between-subjects factors and additional within-subject factors things start to get much more complicated.</p>
</section>
<section id="the-implied-covariance-structure">
<h3>The Implied Covariance Structure<a class="headerlink" href="#the-implied-covariance-structure" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{2}
    y_{ij}             &amp;\sim \mathcal{N}(\mu_{j}, \sigma^{2})             &amp;\quad \text{(Population distribution)} \\
    E(y_{ij})          &amp;=    \mu_{j} = \mu + \alpha_{j}                   &amp;\quad \text{(Mean function)}           \\
    \text{Var}(y_{ij}) &amp;=    \sigma^{2} = \sigma^{2}_{b} + \sigma^{2}_{w} &amp;\quad \text{(Variance function)}.      \\
\end{alignat*}
\end{split}\]</div>
<p>So, we now have a model with a slightly more complex variance function that accommodates the fact that we have two sources of error whenever there are repeated measurements. This also connects directly with the idea that data from the same subject are <em>correlated</em>. The <em>covariance</em> between two measurements from the same subject is given by</p>
<div class="math notranslate nohighlight">
\[
\text{Cov}(y_{i1},y_{i2}) = \text{Cov}(\mu + \alpha_{1} + S_{i} + \epsilon_{i1}, \mu + \alpha_{2} + S_{i} + \epsilon_{i2}) 
\]</div>
<p>Because <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(\alpha_{1}\)</span> and <span class="math notranslate nohighlight">\(\alpha_{2}\)</span> are <em>population constants</em>, they have 0 variance and thus do not contribute to the definition of covariance, leading to</p>
<div class="math notranslate nohighlight">
\[
\text{Cov}(y_{i1},y_{i2}) = \text{Cov}(S_{i} + \epsilon_{i1}, S_{i} + \epsilon_{i2}) 
\]</div>
<p>This can be expanded like so</p>
<div class="math notranslate nohighlight">
\[
\text{Cov}(y_{i1},y_{i2}) = \text{Cov}(S_{i},S_{i}) + \text{Cov}(S_{i},\epsilon_{i2}) + \text{Cov}(\epsilon_{i1},S_{i}) + \text{Cov}(\epsilon_{i1}, \epsilon_{i2}). 
\]</div>
<p>The subject effects and the errors are not correlated as these represent independent partitions of the overall error. As such, <span class="math notranslate nohighlight">\(\text{Cov}(S_{i},\epsilon_{i2}) = \text{Cov}(\epsilon_{i1},S_{i}) = 0\)</span>. Similarly, the final errors are uncorrelated because the correlation has been <em>removed</em> by partitioning-out the subject effects. So <span class="math notranslate nohighlight">\(\text{Cov}(\epsilon_{i1}, \epsilon_{i2}) = 0\)</span>. This leaves</p>
<div class="math notranslate nohighlight">
\[
\text{Cov}(y_{i1},y_{i2}) = \text{Cov}(S_{i},S_{i}).
\]</div>
<p>A key result from the definition of covariance is that the covariance of a random variable with itself is simply its variance, meaning</p>
<div class="math notranslate nohighlight">
\[
\text{Cov}(y_{i1},y_{i2}) = \text{Cov}(S_{i},S_{i}) = \text{Var}(S_{i}) = \sigma^{2}_{b}.
\]</div>
<p>All of which is to say that the variance associated with the subject-specific deflections <em>is</em> the correlation induced by the repeated measurements.</p>
<p>…</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{alignat*}{1}
    \text{Var}\left(y_{i1} - y_{i2}\right) &amp;= \text{Var}(y_{i1}) + \text{Var}(y_{i2}) - 2\text{Cov}(y_{i1},y_{i2}) \\
                                           &amp;= \left[\sigma^{2}_{b} + \sigma^{2}_{w}\right] + \left[\sigma^{2}_{b} + \sigma^{2}_{w}\right] - 2\sigma^{2}_{b} \\
                                           &amp;= \sigma^{2}_{w} + \sigma^{2}_{w}
\end{alignat*}
\end{split}\]</div>
<p>So, we can see that the correlation <em>cancels-out</em>, which is exactly as expected from our exploration of the <em>model of paired differences</em> from earlier.</p>
<p>Now, we will connect what we have done above with the idea of modelling the variance-covariance matrix. Rather than doing this <em>explicitly</em>, the method above was an <em>implicit</em> modelling of the covariance structure…</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
    y_{11} \\
    y_{12} \\
    y_{21} \\
    y_{22} \\
\end{bmatrix}
\sim\mathcal{N}\left(
\begin{bmatrix}
    \mu + \alpha_{1} \\
    \mu + \alpha_{2} \\
    \mu + \alpha_{1} \\
    \mu + \alpha_{2} \\
\end{bmatrix}, 
\begin{bmatrix}
    \sigma^{2}_{b} + \sigma^{2}_{w}  &amp; \sigma^{2}_{b}                  &amp; 0           &amp; 0                     \\
    \sigma^{2}_{b}                   &amp; \sigma^{2}_{b} + \sigma^{2}_{w} &amp; 0           &amp; 0                      \\
    0                                &amp; 0                               &amp; \sigma^{2}_{b} + \sigma^{2}_{w}  &amp; \sigma^{2}_{b}            \\
    0                                &amp; 0           &amp; \sigma^{2}_{b} &amp; \sigma^{2}_{b} + \sigma^{2}_{w}  \\
\end{bmatrix}
\right)
\end{split}\]</div>
<p>So this means that a covariance matrix is never actually calculated within a repeated measures ANOVA, the structure is simply <em>implied</em> via the various model assumptions. Because of this, the correct error terms for the various tests are not derived logically from the structure of the covariance matrix, they need to be organised manually. This is one of the biggest complexities of this framework and is why modern statistics prefers methods where this is taken care of <em>automatically</em> via an explicit covariance structure.</p>
</section>
<section id="the-sphericity-condition">
<h3>The Sphericity Condition<a class="headerlink" href="#the-sphericity-condition" title="Link to this heading">#</a></h3>
<p>… These corrections are available through the <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code> function which, as we will see, is generally the most straight-forward way of generating a repeated measures ANOVA with the correct error partition. For simple models, this will make limited difference. However, as we will see below, more complex models because tricky to specify using <code class="docutils literal notranslate"><span class="pre">aov()</span></code>. This is partly a limitation in the structure of <code class="docutils literal notranslate"><span class="pre">aov()</span></code>, but also points to the general complexity of the repeated measures ANOVA framework.</p>
</section>
</section>
<section id="between-subjects-factors">
<h2>Between-subjects Factors<a class="headerlink" href="#between-subjects-factors" title="Link to this heading">#</a></h2>
<p>… So what is the correct error here? The obvious, and correct, answer is that it is the <em>between-subjects</em> error. So how do we use this in our test statistics? At present, all we have done is <em>removed</em> the between-subjects error by including the <code class="docutils literal notranslate"><span class="pre">Subject</span></code> factor in our models. However, we somehow have to use this removed error as the denominator in tests that are based on between-subjects effects.</p>
</section>
<section id="additional-within-subject-factors">
<h2>Additional Within-subject Factors<a class="headerlink" href="#additional-within-subject-factors" title="Link to this heading">#</a></h2>
<section id="using-the-ezanova-function">
<h3>Using the <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code> Function<a class="headerlink" href="#using-the-ezanova-function" title="Link to this heading">#</a></h3>
<p>As we can see above, using a partitioned error model with <code class="docutils literal notranslate"><span class="pre">aov()</span></code> is a tricky business and it would be very easy to get this wrong. As an alternative, we can use the <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code> function from the <code class="docutils literal notranslate"><span class="pre">ez</span></code> package. As the name implies, this is designed to allow for an RM ANOVA without the usual difficulties associated with the <code class="docutils literal notranslate"><span class="pre">aov()</span></code> or <code class="docutils literal notranslate"><span class="pre">lm()</span></code> functions. Unfortuantely, the aim of this package is largely to make the <code class="docutils literal notranslate"><span class="pre">R</span></code> output the same as SPSS. So it does away with the linear model framework. This means, no residuals, no parameter estimates, no diagnostic plots or anything else we have made use of so far. If you <em>have</em> to use an RM ANOVA, this is the simplest way to get it <em>right</em>. However, as we will discuss below, we would disuade you from ever considering RM ANOVA as an option in the future. About the only utility of this is showing doubtful researchers that our better options of GLS and mixed-effects models are, in fact, giving them the same answer as an RM ANOVA.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ez</span><span class="p">)</span>
<span class="nf">ezANOVA</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="ow">in</span> <span class="n">ezANOVA</span><span class="p">():</span> <span class="n">argument</span> <span class="s2">&quot;data&quot;</span> <span class="ow">is</span> <span class="n">missing</span><span class="p">,</span> <span class="k">with</span> <span class="n">no</span> <span class="n">default</span>
<span class="ne">Traceback</span>:
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="why-we-should-not-use-rm-anova">
<h2>Why We Should <em>Not</em> Use RM ANOVA<a class="headerlink" href="#why-we-should-not-use-rm-anova" title="Link to this heading">#</a></h2>
<p>Everything we have discussed above has really been an exercise in telling you why you really do not want to use RM ANOVA. All the unncessary fiddling with error terms and different tests requiring different errors is a complication that we could simply do without. Even if we do manage to successfully work out what needs to go where (or get a function like <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code> to sort it for us), we are still left with a method that has a number of meaningful restrictions. … Because of this, the RM ANOVA is both tricky to understand, tricky to use correctly and massively inflexible. It is no wonder that statisticians abandoned this method decades ago! And yet, this is the method that has persisted in psychology until releatively recently.</p>
<p>This section has largely been motivational to understand why we want to use something more flexible and more modern, but it is important to recognise that you may well end up working with someone who knows nothing beyond the RM ANOVA. In those situations, it is useful to (a) motivate the need for something better and (b) understand how to get the RM ANOVA results in <code class="docutils literal notranslate"><span class="pre">R</span></code>, in case they require further convincing. So, we do not condone the use of the RM ANOVA, but we understand its place in psychology and also understand that there are times where you may want to see what the RM ANOVA says, even if you do not wish to use it.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3.paired-t.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The Paired <em>t</em>-test</p>
      </div>
    </a>
    <a class="right-next"
       href="5.gls.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Generalised Least Squares</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations-of-the-model-of-paired-differences">Limitations of the Model of <em>Paired Differences</em></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-model-of-partitioned-errors">The Model of <em>Partitioned Errors</em></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partitioned-errors-in-r">Partitioned Errors in <code class="docutils literal notranslate"><span class="pre">R</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-implied-covariance-structure">The Implied Covariance Structure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-sphericity-condition">The Sphericity Condition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#between-subjects-factors">Between-subjects Factors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-within-subject-factors">Additional Within-subject Factors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-ezanova-function">Using the <code class="docutils literal notranslate"><span class="pre">ezANOVA()</span></code> Function</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-we-should-not-use-rm-anova">Why We Should <em>Not</em> Use RM ANOVA</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>